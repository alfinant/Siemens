##############################################################################
#                                                                            #
# IAR ARM ANSI C/C++ Compiler V4.42A/W32 EVALUATION    16/Feb/2023  22:41:18 #
# Copyright 1999-2005 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Cpu mode        =  interwork                                            #
#    Endian          =  little                                               #
#    Stack alignment =  4                                                    #
#    Source file     =  D:\Users\alfinant\Documents\Siemens\Dev\IAR\VK.ELF_C #
#                       \vk_api.c                                            #
#    Command line    =  D:\Users\alfinant\Documents\Siemens\Dev\IAR\VK.ELF_C #
#                       \vk_api.c -D NEWSGOLD -D ELKA -D DEBUG -lCN          #
#                       D:\Users\alfinant\Documents\Siemens\Dev\IAR\VK.ELF_C #
#                       \Release_ELKA\List\ -la D:\Users\alfinant\Documents\ #
#                       Siemens\Dev\IAR\VK.ELF_C\Release_ELKA\List\ -o       #
#                       D:\Users\alfinant\Documents\Siemens\Dev\IAR\VK.ELF_C #
#                       \Release_ELKA\Obj\ -z9 --cpu_mode arm --endian       #
#                       little --cpu ARM926EJ-S --stack_align 4 --interwork  #
#                       --diag_suppress Pe301 -e --fpu None --dlib_config    #
#                       D:\Users\alfinant\Documents\Siemens\IAR\ARM\LIB\dl5t #
#                       painl8n.h -I D:\Users\alfinant\Documents\Siemens\IAR #
#                       \ARM\INC\ --inline_threshold=2                       #
#    List file       =  D:\Users\alfinant\Documents\Siemens\Dev\IAR\VK.ELF_C #
#                       \Release_ELKA\List\vk_api.lst                        #
#    Object file     =  D:\Users\alfinant\Documents\Siemens\Dev\IAR\VK.ELF_C #
#                       \Release_ELKA\Obj\vk_api.r79                         #
#                                                                            #
#                                                                            #
##############################################################################

D:\Users\alfinant\Documents\Siemens\Dev\IAR\VK.ELF_C\vk_api.c
      1          #include "vk_api.h"
      2          
      3          #include <siemens/swilib.h>
      4          #include "socket_work.h"
      5          #include "http.h"
      6          #include "url_utils.h"
      7          #include "main.h"
      8          #include "vk_work.h"
      9          #include "string_util.h"
     10          #include "buffer.h"
     11          
     12          #include "json/cJSON.h"
     13          

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "access_token">`:
   \   00000000   616363657373       DC8 "access_token"
   \              5F746F6B656E
   \              00          
   \   0000000D   000000             DC8 0, 0, 0
   \   00000010   757365725F69       DC8 "user_id"
   \              6400        
   \   00000018   6572726F725F       DC8 "error_description"
   \              646573637269
   \              7074696F6E00
   \   0000002A   0000               DC8 0, 0
   \   0000002C   6E6565645F76       DC8 "need_validation"
   \              616C69646174
   \              696F6E00    
   \   0000003C   6E6565645F63       DC8 "need_captcha"
   \              617074636861
   \              00          
   \   00000049   000000             DC8 0, 0, 0
   \   0000004C   6D6573736167       DC8 "messages"
   \              657300      
   \   00000055   000000             DC8 0, 0, 0
   \   00000058   6E65775F7074       DC8 "new_pts"
   \              7300        
   \   00000060   636F6E766572       DC8 "conversation"
   \              736174696F6E
   \              00          
   \   0000006D   000000             DC8 0, 0, 0
   \   00000070   6F75745F7265       DC8 "out_read"
   \              616400      
   \   00000079   000000             DC8 0, 0, 0
   \   0000007C   756E72656164       DC8 "unread_count"
   \              5F636F756E74
   \              00          
   \   00000089   000000             DC8 0, 0, 0
   \   0000008C   6C6173745F6D       DC8 "last_message"
   \              657373616765
   \              00          
   \   00000099   000000             DC8 0, 0, 0
   \   0000009C   67726F757073       DC8 "groups"
   \              00          
   \   000000A3   00                 DC8 0
   \   000000A4   736572766572       DC8 "server"
   \              00          
   \   000000AB   00                 DC8 0
   \   000000AC   6572726F7200       DC8 "error"
   \   000000B2   0000               DC8 0, 0
   \   000000B4   726573706F6E       DC8 "response"
   \              736500      
   \   000000BD   000000             DC8 0, 0, 0
   \   000000C0   636F756E7400       DC8 "count"
   \   000000C6   0000               DC8 0, 0
   \   000000C8   6974656D7300       DC8 "items"
   \   000000CE   0000               DC8 0, 0
   \   000000D0   70726F66696C       DC8 "profiles"
   \              657300      
   \   000000D9   000000             DC8 0, 0, 0
     14          static const char t_error[] = "error";
     15          static const char t_response[] = "response";
     16          static const char t_count[] = "count";
     17          static const char t_items[] = "items";

   \                                 In segment DATA_C, align 4, align-sorted
     18          static const char t_id[] = "id";
   \                     t_id:
   \   00000000   696400             DC8 "id"
   \   00000003   00                 DC8 0
   \   00000004   6F6E6C696E65       DC8 "online"
   \              00          
   \   0000000B   00                 DC8 0
   \   0000000C   6E616D6500         DC8 "name"
   \   00000011   000000             DC8 0, 0, 0
   \   00000014   73637265656E       DC8 "screen_name"
   \              5F6E616D6500
   \   00000020   69735F636C6F       DC8 "is_closed"
   \              73656400    
   \   0000002A   0000               DC8 0, 0
   \   0000002C   6576656E7400       DC8 "event"
   \   00000032   0000               DC8 0, 0
   \   00000034   7061676500         DC8 "page"
   \   00000039   000000             DC8 0, 0, 0
   \   0000003C   67726F757000       DC8 "group"
   \   00000042   0000               DC8 0, 0
   \   00000044   69735F6D656D       DC8 "is_member"
   \              62657200    
   \   0000004E   0000               DC8 0, 0
   \   00000050   70686F746F00       DC8 "photo"
   \   00000056   0000               DC8 0, 0
   \   00000058   6461746500         DC8 "date"
   \   0000005D   000000             DC8 0, 0, 0
   \   00000060   66726F6D5F69       DC8 "from_id"
   \              6400        
   \   00000068   706565725F69       DC8 "peer_id"
   \              6400        
   \   00000070   7465787400         DC8 "text"
   \   00000075   000000             DC8 0, 0, 0
   \   00000078   617474616368       DC8 "attachments"
   \              6D656E747300
   \   00000084   66697273745F       DC8 "first_name"
   \              6E616D6500  
   \   0000008F   00                 DC8 0
   \   00000090   6C6173745F6E       DC8 "last_name"
   \              616D6500    
   \   0000009A   0000               DC8 0, 0
   \   0000009C   667269656E64       DC8 "friend_status"
   \              5F7374617475
   \              7300        
   \   000000AA   0000               DC8 0, 0
   \   000000AC   646561637469       DC8 "deactivated"
   \              766174656400
   \   000000B8   6861735F7068       DC8 "has_photo"
   \              6F746F00    
   \   000000C2   0000               DC8 0, 0
   \   000000C4   70686F746F5F       DC8 "photo_50"
   \              353000      
   \   000000CD   000000             DC8 0, 0, 0
   \   000000D0   7479706500         DC8 "type"
   \   000000D5   000000             DC8 0, 0, 0
     19          static const char t_deactivated[] = "deactivated";
     20          static const char t_has_photo[] = "has_photo";
     21          static const char t_photo_50[] = "photo_50";
     22          static const char t_profiles[] = "profiles";
     23          static const char t_type[] = "type";
     24          
     25          extern int maincsm_id;
     26          
     27          int my_id = 0;
     28          
     29          char ACCESS_TOKEN[ACCESS_TOKEN_MAXLEN];
     30          static const unsigned APP_ID = 5582937;

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "%s/execute.getHistory...">`:
   \   00000000   25732F657865       DC8 25H, 73H, 2FH, 65H, 78H, 65H, 63H, 75H
   \              6375        
   \   00000008   74652E676574       DC8 74H, 65H, 2EH, 67H, 65H, 74H, 48H, 69H
   \              4869        
   \   00000010   73746F72792E       DC8 73H, 74H, 6FH, 72H, 79H, 2EH, 78H, 6DH
   \              786D        
   \   00000018   6C3F61636365       DC8 6CH, 3FH, 61H, 63H, 63H, 65H, 73H, 73H
   \              7373        
   \   00000020   5F746F6B656E       DC8 5FH, 74H, 6FH, 6BH, 65H, 6EH, 3DH, 25H
   \              3D25        
   \   00000028   7326763D2573       DC8 73H, 26H, 76H, 3DH, 25H, 73H, 26H, 75H
   \              2675        
   \   00000030   7365725F6964       DC8 73H, 65H, 72H, 5FH, 69H, 64H, 3DH, 25H
   \              3D25        
   \   00000038   6426636F756E       DC8 64H, 26H, 63H, 6FH, 75H, 6EH, 74H, 3DH
   \              743D        
   \   00000040   25642666756E       DC8 25H, 64H, 26H, 66H, 75H, 6EH, 63H, 5FH
   \              635F        
   \   00000048   763D3100           DC8 76H, 3DH, 31H, 0
   \   0000004C   68747470733A       DC8 68H, 74H, 74H, 70H, 73H, 3AH, 2FH, 2FH
   \              2F2F        
   \   00000054   6F617574682E       DC8 6FH, 61H, 75H, 74H, 68H, 2EH, 76H, 6BH
   \              766B        
   \   0000005C   2E636F6D2F74       DC8 2EH, 63H, 6FH, 6DH, 2FH, 74H, 6FH, 6BH
   \              6F6B        
   \   00000064   656E3F677261       DC8 65H, 6EH, 3FH, 67H, 72H, 61H, 6EH, 74H
   \              6E74        
   \   0000006C   5F747970653D       DC8 5FH, 74H, 79H, 70H, 65H, 3DH, 70H, 61H
   \              7061        
   \   00000074   7373776F7264       DC8 73H, 73H, 77H, 6FH, 72H, 64H, 26H, 63H
   \              2663        
   \   0000007C   6C69656E745F       DC8 6CH, 69H, 65H, 6EH, 74H, 5FH, 69H, 64H
   \              6964        
   \   00000084   3D256426636C       DC8 3DH, 25H, 64H, 26H, 63H, 6CH, 69H, 65H
   \              6965        
   \   0000008C   6E745F736563       DC8 6EH, 74H, 5FH, 73H, 65H, 63H, 72H, 65H
   \              7265        
   \   00000094   743D25732675       DC8 74H, 3DH, 25H, 73H, 26H, 75H, 73H, 65H
   \              7365        
   \   0000009C   726E616D653D       DC8 72H, 6EH, 61H, 6DH, 65H, 3DH, 25H, 73H
   \              2573        
   \   000000A4   267061737377       DC8 26H, 70H, 61H, 73H, 73H, 77H, 6FH, 72H
   \              6F72        
   \   000000AC   643D25732673       DC8 64H, 3DH, 25H, 73H, 26H, 73H, 63H, 6FH
   \              636F        
   \   000000B4   70653D256426       DC8 70H, 65H, 3DH, 25H, 64H, 26H, 76H, 3DH
   \              763D        
   \   000000BC   257326326661       DC8 25H, 73H, 26H, 32H, 66H, 61H, 5FH, 73H
   \              5F73        
   \   000000C4   7570706F7274       DC8 75H, 70H, 70H, 6FH, 72H, 74H, 65H, 64H
   \              6564        
   \   000000CC   3D3000             DC8 3DH, 30H, 0
   \   000000CF   00                 DC8 0
   \   000000D0   25732F737461       DC8 "%s/stats.trackVisitor?v=%s&access_token=%s"
   \              74732E747261
   \              636B56697369
   \              746F723F763D
   \              257326616363
   \              6573735F746F
   \              6B656E3D2573
   \              00          
   \   000000FB   00                 DC8 0
   \   000000FC   25732F6D6573       DC8 25H, 73H, 2FH, 6DH, 65H, 73H, 73H, 61H
   \              7361        
   \   00000104   6765732E6765       DC8 67H, 65H, 73H, 2EH, 67H, 65H, 74H, 4CH
   \              744C        
   \   0000010C   6F6E67506F6C       DC8 6FH, 6EH, 67H, 50H, 6FH, 6CH, 6CH, 53H
   \              6C53        
   \   00000114   65727665723F       DC8 65H, 72H, 76H, 65H, 72H, 3FH, 76H, 3DH
   \              763D        
   \   0000011C   257326616363       DC8 25H, 73H, 26H, 61H, 63H, 63H, 65H, 73H
   \              6573        
   \   00000124   735F746F6B65       DC8 73H, 5FH, 74H, 6FH, 6BH, 65H, 6EH, 3DH
   \              6E3D        
   \   0000012C   2573266E6565       DC8 25H, 73H, 26H, 6EH, 65H, 65H, 64H, 5FH
   \              645F        
   \   00000134   7074733D2564       DC8 70H, 74H, 73H, 3DH, 25H, 64H, 26H, 67H
   \              2667        
   \   0000013C   726F75705F69       DC8 72H, 6FH, 75H, 70H, 5FH, 69H, 64H, 3DH
   \              643D        
   \   00000144   2564266C705F       DC8 25H, 64H, 26H, 6CH, 70H, 5FH, 76H, 65H
   \              7665        
   \   0000014C   7273696F6E3D       DC8 72H, 73H, 69H, 6FH, 6EH, 3DH, 25H, 64H
   \              2564        
   \   00000154   00                 DC8 0
   \   00000155   000000             DC8 0, 0, 0
   \   00000158   25732F6D6573       DC8 25H, 73H, 2FH, 6DH, 65H, 73H, 73H, 61H
   \              7361        
   \   00000160   6765732E6765       DC8 67H, 65H, 73H, 2EH, 67H, 65H, 74H, 4CH
   \              744C        
   \   00000168   6F6E67506F6C       DC8 6FH, 6EH, 67H, 50H, 6FH, 6CH, 6CH, 48H
   \              6C48        
   \   00000170   6973746F7279       DC8 69H, 73H, 74H, 6FH, 72H, 79H, 3FH, 76H
   \              3F76        
   \   00000178   3D2573266163       DC8 3DH, 25H, 73H, 26H, 61H, 63H, 63H, 65H
   \              6365        
   \   00000180   73735F746F6B       DC8 73H, 73H, 5FH, 74H, 6FH, 6BH, 65H, 6EH
   \              656E        
   \   00000188   3D2573267473       DC8 3DH, 25H, 73H, 26H, 74H, 73H, 3DH, 25H
   \              3D25        
   \   00000190   64267074733D       DC8 64H, 26H, 70H, 74H, 73H, 3DH, 25H, 64H
   \              2564        
   \   00000198   266669656C64       DC8 26H, 66H, 69H, 65H, 6CH, 64H, 73H, 3DH
   \              733D        
   \   000001A0   2573266C705F       DC8 25H, 73H, 26H, 6CH, 70H, 5FH, 76H, 65H
   \              7665        
   \   000001A8   7273696F6E3D       DC8 72H, 73H, 69H, 6FH, 6EH, 3DH, 25H, 64H
   \              2564        
   \   000001B0   00                 DC8 0
   \   000001B1   000000             DC8 0, 0, 0
   \   000001B4   25732F6D6573       DC8 25H, 73H, 2FH, 6DH, 65H, 73H, 73H, 61H
   \              7361        
   \   000001BC   6765732E6765       DC8 67H, 65H, 73H, 2EH, 67H, 65H, 74H, 43H
   \              7443        
   \   000001C4   6F6E76657273       DC8 6FH, 6EH, 76H, 65H, 72H, 73H, 61H, 74H
   \              6174        
   \   000001CC   696F6E733F76       DC8 69H, 6FH, 6EH, 73H, 3FH, 76H, 3DH, 25H
   \              3D25        
   \   000001D4   732661636365       DC8 73H, 26H, 61H, 63H, 63H, 65H, 73H, 73H
   \              7373        
   \   000001DC   5F746F6B656E       DC8 5FH, 74H, 6FH, 6BH, 65H, 6EH, 3DH, 25H
   \              3D25        
   \   000001E4   73266F666673       DC8 73H, 26H, 6FH, 66H, 66H, 73H, 65H, 74H
   \              6574        
   \   000001EC   3D256426636F       DC8 3DH, 25H, 64H, 26H, 63H, 6FH, 75H, 6EH
   \              756E        
   \   000001F4   743D25642665       DC8 74H, 3DH, 25H, 64H, 26H, 65H, 78H, 74H
   \              7874        
   \   000001FC   656E6465643D       DC8 65H, 6EH, 64H, 65H, 64H, 3DH, 25H, 64H
   \              2564        
   \   00000204   266669656C64       DC8 26H, 66H, 69H, 65H, 6CH, 64H, 73H, 3DH
   \              733D        
   \   0000020C   257300             DC8 25H, 73H, 0
   \   0000020F   00                 DC8 0
   \   00000210   25732F757365       DC8 25H, 73H, 2FH, 75H, 73H, 65H, 72H, 73H
   \              7273        
   \   00000218   2E6765743F76       DC8 2EH, 67H, 65H, 74H, 3FH, 76H, 3DH, 25H
   \              3D25        
   \   00000220   732661636365       DC8 73H, 26H, 61H, 63H, 63H, 65H, 73H, 73H
   \              7373        
   \   00000228   5F746F6B656E       DC8 5FH, 74H, 6FH, 6BH, 65H, 6EH, 3DH, 25H
   \              3D25        
   \   00000230   732675736572       DC8 73H, 26H, 75H, 73H, 65H, 72H, 5FH, 69H
   \              5F69        
   \   00000238   64733D257326       DC8 64H, 73H, 3DH, 25H, 73H, 26H, 66H, 69H
   \              6669        
   \   00000240   656C64733D25       DC8 65H, 6CH, 64H, 73H, 3DH, 25H, 73H, 0
   \              7300        
   \   00000248   25732F6D6573       DC8 25H, 73H, 2FH, 6DH, 65H, 73H, 73H, 61H
   \              7361        
   \   00000250   6765732E6765       DC8 67H, 65H, 73H, 2EH, 67H, 65H, 74H, 48H
   \              7448        
   \   00000258   6973746F7279       DC8 69H, 73H, 74H, 6FH, 72H, 79H, 3FH, 61H
   \              3F61        
   \   00000260   63636573735F       DC8 63H, 63H, 65H, 73H, 73H, 5FH, 74H, 6FH
   \              746F        
   \   00000268   6B656E3D2573       DC8 6BH, 65H, 6EH, 3DH, 25H, 73H, 26H, 76H
   \              2676        
   \   00000270   3D2573267573       DC8 3DH, 25H, 73H, 26H, 75H, 73H, 65H, 72H
   \              6572        
   \   00000278   5F69643D2564       DC8 5FH, 69H, 64H, 3DH, 25H, 64H, 26H, 63H
   \              2663        
   \   00000280   6F756E743D25       DC8 6FH, 75H, 6EH, 74H, 3DH, 25H, 64H, 26H
   \              6426        
   \   00000288   73746172745F       DC8 73H, 74H, 61H, 72H, 74H, 5FH, 6DH, 65H
   \              6D65        
   \   00000290   73736167655F       DC8 73H, 73H, 61H, 67H, 65H, 5FH, 69H, 64H
   \              6964        
   \   00000298   3D256400           DC8 3DH, 25H, 64H, 0
   \   0000029C   25732F6D6573       DC8 25H, 73H, 2FH, 6DH, 65H, 73H, 73H, 61H
   \              7361        
   \   000002A4   6765732E6465       DC8 67H, 65H, 73H, 2EH, 64H, 65H, 6CH, 65H
   \              6C65        
   \   000002AC   74654469616C       DC8 74H, 65H, 44H, 69H, 61H, 6CH, 6FH, 67H
   \              6F67        
   \   000002B4   3F6163636573       DC8 3FH, 61H, 63H, 63H, 65H, 73H, 73H, 5FH
   \              735F        
   \   000002BC   746F6B656E3D       DC8 74H, 6FH, 6BH, 65H, 6EH, 3DH, 25H, 73H
   \              2573        
   \   000002C4   26763D257326       DC8 26H, 76H, 3DH, 25H, 73H, 26H, 75H, 73H
   \              7573        
   \   000002CC   65725F69643D       DC8 65H, 72H, 5FH, 69H, 64H, 3DH, 25H, 64H
   \              2564        
   \   000002D4   26636F756E74       DC8 26H, 63H, 6FH, 75H, 6EH, 74H, 3DH, 25H
   \              3D25        
   \   000002DC   6400               DC8 64H, 0
   \   000002DE   0000               DC8 0, 0
   \   000002E0   25732F6D6573       DC8 25H, 73H, 2FH, 6DH, 65H, 73H, 73H, 61H
   \              7361        
   \   000002E8   6765732E6D61       DC8 67H, 65H, 73H, 2EH, 6DH, 61H, 72H, 6BH
   \              726B        
   \   000002F0   417352656164       DC8 41H, 73H, 52H, 65H, 61H, 64H, 3FH, 76H
   \              3F76        
   \   000002F8   3D2573266163       DC8 3DH, 25H, 73H, 26H, 61H, 63H, 63H, 65H
   \              6365        
   \   00000300   73735F746F6B       DC8 73H, 73H, 5FH, 74H, 6FH, 6BH, 65H, 6EH
   \              656E        
   \   00000308   3D2573266D65       DC8 3DH, 25H, 73H, 26H, 6DH, 65H, 73H, 73H
   \              7373        
   \   00000310   6167655F6964       DC8 61H, 67H, 65H, 5FH, 69H, 64H, 73H, 3DH
   \              733D        
   \   00000318   257326706565       DC8 25H, 73H, 26H, 70H, 65H, 65H, 72H, 5FH
   \              725F        
   \   00000320   69643D256400       DC8 69H, 64H, 3DH, 25H, 64H, 0
   \   00000326   0000               DC8 0, 0
   \   00000328   25732F667269       DC8 25H, 73H, 2FH, 66H, 72H, 69H, 65H, 6EH
   \              656E        
   \   00000330   64732E676574       DC8 64H, 73H, 2EH, 67H, 65H, 74H, 3FH, 76H
   \              3F76        
   \   00000338   3D2573266163       DC8 3DH, 25H, 73H, 26H, 61H, 63H, 63H, 65H
   \              6365        
   \   00000340   73735F746F6B       DC8 73H, 73H, 5FH, 74H, 6FH, 6BH, 65H, 6EH
   \              656E        
   \   00000348   3D257326636F       DC8 3DH, 25H, 73H, 26H, 63H, 6FH, 75H, 6EH
   \              756E        
   \   00000350   743D2564266F       DC8 74H, 3DH, 25H, 64H, 26H, 6FH, 66H, 66H
   \              6666        
   \   00000358   7365743D2564       DC8 73H, 65H, 74H, 3DH, 25H, 64H, 26H, 6FH
   \              266F        
   \   00000360   726465723D25       DC8 72H, 64H, 65H, 72H, 3DH, 25H, 73H, 26H
   \              7326        
   \   00000368   6669656C6473       DC8 66H, 69H, 65H, 6CH, 64H, 73H, 3DH, 25H
   \              3D25        
   \   00000370   7300               DC8 73H, 0
   \   00000372   0000               DC8 0, 0
   \   00000374   763D25732661       DC8 "v=%s&access_token=%s&user_id=%d&message=%s"
   \              63636573735F
   \              746F6B656E3D
   \              257326757365
   \              725F69643D25
   \              64266D657373
   \              6167653D2573
   \              00          
   \   0000039F   00                 DC8 0
   \   000003A0   25732F67726F       DC8 25H, 73H, 2FH, 67H, 72H, 6FH, 75H, 70H
   \              7570        
   \   000003A8   732E6765743F       DC8 73H, 2EH, 67H, 65H, 74H, 3FH, 76H, 3DH
   \              763D        
   \   000003B0   257326616363       DC8 25H, 73H, 26H, 61H, 63H, 63H, 65H, 73H
   \              6573        
   \   000003B8   735F746F6B65       DC8 73H, 5FH, 74H, 6FH, 6BH, 65H, 6EH, 3DH
   \              6E3D        
   \   000003C0   2573266F6666       DC8 25H, 73H, 26H, 6FH, 66H, 66H, 73H, 65H
   \              7365        
   \   000003C8   743D25642663       DC8 74H, 3DH, 25H, 64H, 26H, 63H, 6FH, 75H
   \              6F75        
   \   000003D0   6E743D256426       DC8 6EH, 74H, 3DH, 25H, 64H, 26H, 65H, 78H
   \              6578        
   \   000003D8   74656E646564       DC8 74H, 65H, 6EH, 64H, 65H, 64H, 3DH, 31H
   \              3D31        
   \   000003E0   00                 DC8 0
   \   000003E1   000000             DC8 0, 0, 0
   \   000003E4   25732F67726F       DC8 25H, 73H, 2FH, 67H, 72H, 6FH, 75H, 70H
   \              7570        
   \   000003EC   732E67657442       DC8 73H, 2EH, 67H, 65H, 74H, 42H, 79H, 49H
   \              7949        
   \   000003F4   643F763D2573       DC8 64H, 3FH, 76H, 3DH, 25H, 73H, 26H, 61H
   \              2661        
   \   000003FC   63636573735F       DC8 63H, 63H, 65H, 73H, 73H, 5FH, 74H, 6FH
   \              746F        
   \   00000404   6B656E3D2573       DC8 6BH, 65H, 6EH, 3DH, 25H, 73H, 26H, 67H
   \              2667        
   \   0000040C   726F75705F69       DC8 72H, 6FH, 75H, 70H, 5FH, 69H, 64H, 73H
   \              6473        
   \   00000414   3D2573266669       DC8 3DH, 25H, 73H, 26H, 66H, 69H, 65H, 6CH
   \              656C        
   \   0000041C   64733D257300       DC8 64H, 73H, 3DH, 25H, 73H, 0
   \   00000422   0000               DC8 0, 0
   \   00000424   25732F77616C       DC8 25H, 73H, 2FH, 77H, 61H, 6CH, 6CH, 2EH
   \              6C2E        
   \   0000042C   6765743F763D       DC8 67H, 65H, 74H, 3FH, 76H, 3DH, 25H, 73H
   \              2573        
   \   00000434   266163636573       DC8 26H, 61H, 63H, 63H, 65H, 73H, 73H, 5FH
   \              735F        
   \   0000043C   746F6B656E3D       DC8 74H, 6FH, 6BH, 65H, 6EH, 3DH, 25H, 73H
   \              2573        
   \   00000444   266F776E6572       DC8 26H, 6FH, 77H, 6EH, 65H, 72H, 5FH, 69H
   \              5F69        
   \   0000044C   643D25642663       DC8 64H, 3DH, 25H, 64H, 26H, 63H, 6FH, 75H
   \              6F75        
   \   00000454   6E743D31266F       DC8 6EH, 74H, 3DH, 31H, 26H, 6FH, 66H, 66H
   \              6666        
   \   0000045C   7365743D2564       DC8 73H, 65H, 74H, 3DH, 25H, 64H, 26H, 65H
   \              2665        
   \   00000464   7874656E6465       DC8 78H, 74H, 65H, 6EH, 64H, 65H, 64H, 3DH
   \              643D        
   \   0000046C   256400             DC8 25H, 64H, 0
   \   0000046F   00                 DC8 0
   \   00000470   616363657373       DC8 61H, 63H, 63H, 65H, 73H, 73H, 5FH, 74H
   \              5F74        
   \   00000478   6F6B656E3D25       DC8 6FH, 6BH, 65H, 6EH, 3DH, 25H, 73H, 26H
   \              7326        
   \   00000480   763D25732666       DC8 76H, 3DH, 25H, 73H, 26H, 66H, 75H, 6EH
   \              756E        
   \   00000488   635F763D3126       DC8 63H, 5FH, 76H, 3DH, 31H, 26H, 75H, 73H
   \              7573        
   \   00000490   65725F69643D       DC8 65H, 72H, 5FH, 69H, 64H, 3DH, 25H, 64H
   \              2564        
   \   00000498   266C6173745F       DC8 26H, 6CH, 61H, 73H, 74H, 5FH, 6DH, 65H
   \              6D65        
   \   000004A0   73736167655F       DC8 73H, 73H, 61H, 67H, 65H, 5FH, 69H, 64H
   \              6964        
   \   000004A8   3D2564266D65       DC8 3DH, 25H, 64H, 26H, 6DH, 65H, 73H, 73H
   \              7373        
   \   000004B0   6167653D2573       DC8 61H, 67H, 65H, 3DH, 25H, 73H, 0
   \              00          
   \   000004B7   00                 DC8 0
   \   000004B8   794A56445169       DC8 "yJVDQi2ry8J1hWS5MlYH"
   \              327279384A31
   \              685753354D6C
   \              594800      
   \   000004CD   000000             DC8 0, 0, 0
   \   000004D0   68747470733A       DC8 "https://api.vk.com/method"
   \              2F2F6170692E
   \              766B2E636F6D
   \              2F6D6574686F
   \              6400        
   \   000004EA   0000               DC8 0, 0
   \   000004EC   352E393200         DC8 "5.92"
   \   000004F1   000000             DC8 0, 0, 0
     31          static const char SECRET_KEY[] = "yJVDQi2ry8J1hWS5MlYH";
     32          static const char API_DIR[]="https://api.vk.com/method";
     33          static const char API_VER[]="5.92";
     34          
     35          
     36          int captcha_seed;

   \                                 In segment DATA_C, align 4, align-sorted
     37          const char captcha_img[128];
   \                     captcha_img:
   \   00000000   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    
   \   00000010   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    
   \   00000020   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    
   \   00000030   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    
   \   00000040   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    
   \   00000050   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    
   \   00000060   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    
   \   00000070   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    

   \                                 In segment DATA_Z, align 4, align-sorted
   \                     my_id:
   \   00000000                      DS8 4
     38          char err_msg[256];
     39          static char sbuf[1024];
     40          
     41          //LongPoolServer
     42          #define LP_VERSION     3
     43          static char lp_key[64];
     44          static char lp_server[32];
     45          unsigned lp_ts = 0;
   \                     lp_ts:
   \   00000004                      DS8 4
     46          unsigned pts = 0;
   \                     pts:
   \   00000008                      DS8 4
   \                     ACCESS_TOKEN:
   \   0000000C                      DS8 256
   \                     err_msg:
   \   0000010C                      DS8 256
   \   0000020C                      DS8 1024
   \   0000060C                      DS8 64
   \   0000064C                      DS8 32

   \                                 In segment DATA_Z, align 4, align-sorted
   \                     captcha_seed:
   \   00000000                      DS8 4
     47          
     48          //Прямая авторизация. Разрешение выдано 11.09.2017.

   \                                 In segment CODE, align 4, keep-with-next
     49          char* url_auth_direct(char *username, char *password, unsigned scope)
     50          {
     51            snprintf(sbuf, 511, "https://oauth.vk.com/token?grant_type=password&client_id=%d&client_secret=%s"
     52                     "&username=%s&password=%s&scope=%d&v=%s&2fa_supported=0", APP_ID, SECRET_KEY, username, password, scope, API_VER);
   \                     url_auth_direct:
   \   00000000   ........           LDR      R12,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   ........           LDR      R5,??DataTable51  ;; my_id
   \   0000000C   834FA0E3           MOV      R4,#+524
   \   00000010   B83F84E2           ADD      R3,R4,#+736
   \   00000014   0C3083E0           ADD      R3,R3,R12
   \   00000018   08002DE9           PUSH     {R3}
   \   0000001C   1C309FE5           LDR      R3,??url_auth_direct_0  ;; 0x553059
   \   00000020   04002DE9           PUSH     {R2}
   \   00000024   02002DE9           PUSH     {R1}
   \   00000028   01002DE9           PUSH     {R0}
   \   0000002C   4C208CE2           ADD      R2,R12,#+76
   \   00000030   0D1044E2           SUB      R1,R4,#+13
   \   00000034   AB0F84E2           ADD      R0,R4,#+684
   \   00000038   0C0080E0           ADD      R0,R0,R12
   \   0000003C   ........           B        ?Subroutine31
   \                     ??url_auth_direct_0:
   \   00000040   59305500           DC32     0x553059
     53            return sbuf;
     54          }

   \                                 In segment CODE, align 4, keep-with-next
   \                     ?Subroutine31:
   \   00000000   01002DE9           PUSH     {R0}
   \                     ??Subroutine31_0:
   \   00000004   050084E0           ADD      R0,R4,R5
   \   00000008   1B0100EF           SWI      +283
   \   0000000C   050084E0           ADD      R0,R4,R5
   \   00000010   14D08DE2           ADD      SP,SP,#+20
   \   00000014   3080BDE8           POP      {R4,R5,PC}       ;; return
     55          

   \                                 In segment CODE, align 4, keep-with-next
     56          char* url_stats_track_visitor()
     57          {
     58            snprintf(sbuf, 511, "%s/stats.trackVisitor?v=%s&access_token=%s", API_DIR, API_VER, ACCESS_TOKEN);
   \                     url_stats_track_visitor:
   \   00000000   ........           LDR      R0,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   ........           LDR      R5,??DataTable51  ;; my_id
   \   0000000C   834FA0E3           MOV      R4,#+524
   \   00000010   0C1085E2           ADD      R1,R5,#+12
   \   00000014   02002DE9           PUSH     {R1}
   \   00000018   4D3E80E2           ADD      R3,R0,#+1232
   \   0000001C   D02080E2           ADD      R2,R0,#+208
   \   00000020   B81F84E2           ADD      R1,R4,#+736
   \   00000024   001081E0           ADD      R1,R1,R0
   \   00000028   02002DE9           PUSH     {R1}
   \   0000002C   050084E0           ADD      R0,R4,R5
   \   00000030   0D1044E2           SUB      R1,R4,#+13
   \   00000034   1B0100EF           SWI      +283
     59            return sbuf;
   \   00000038   050084E0           ADD      R0,R4,R5
   \   0000003C   3680BDE8           POP      {R1,R2,R4,R5,PC}  ;; return
     60          }
     61          

   \                                 In segment CODE, align 4, keep-with-next
     62          char* url_messages_getLongPollServer(int need_pts, int group_id/*,int lp_version*/)
     63          {
   \                     url_messages_getLongPollServer:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
     64            snprintf(sbuf, 511, "%s/messages.getLongPollServer?v=%s&access_token=%s&need_pts=%d&group_id=%d&lp_version=%d", API_DIR, API_VER, ACCESS_TOKEN, need_pts, group_id, LP_VERSION);
   \   00000004   ........           LDR      R2,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   00000008   ........           LDR      R5,??DataTable51  ;; my_id
   \   0000000C   0330A0E3           MOV      R3,#+3
   \   00000010   08002DE9           PUSH     {R3}
   \   00000014   02002DE9           PUSH     {R1}
   \   00000018   01002DE9           PUSH     {R0}
   \   0000001C   834FA0E3           MOV      R4,#+524
   \   00000020   4D3E82E2           ADD      R3,R2,#+1232
   \   00000024   0D1044E2           SUB      R1,R4,#+13
   \   00000028   0C0085E2           ADD      R0,R5,#+12
   \   0000002C   01002DE9           PUSH     {R0}
   \   00000030   B80F84E2           ADD      R0,R4,#+736
   \   00000034   020080E0           ADD      R0,R0,R2
   \   00000038   01002DE9           PUSH     {R0}
   \   0000003C   FC2082E2           ADD      R2,R2,#+252
   \   00000040   ........           B        ??Subroutine31_0
     65            return sbuf;
     66          }
     67          
     68          

   \                                 In segment CODE, align 4, keep-with-next
     69          char* url_messages_getLongPollHistory(/*int ts, int pts, */ const char* fields)
     70          {
   \                     url_messages_getLongPollHistory:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
     71            snprintf(sbuf, 511, "%s/messages.getLongPollHistory?v=%s&access_token=%s&ts=%d&pts=%d&fields=%s&lp_version=%d", API_DIR, API_VER, ACCESS_TOKEN, lp_ts, pts, fields, LP_VERSION);
   \   00000004   ........           LDR      R1,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   00000008   ........           LDR      R5,??DataTable51  ;; my_id
   \   0000000C   0320A0E3           MOV      R2,#+3
   \   00000010   04002DE9           PUSH     {R2}
   \   00000014   01002DE9           PUSH     {R0}
   \   00000018   080095E5           LDR      R0,[R5, #+8]
   \   0000001C   834FA0E3           MOV      R4,#+524
   \   00000020   01002DE9           PUSH     {R0}
   \   00000024   040095E5           LDR      R0,[R5, #+4]
   \   00000028   4D3E81E2           ADD      R3,R1,#+1232
   \   0000002C   01002DE9           PUSH     {R0}
   \   00000030   562F81E2           ADD      R2,R1,#+344
   \   00000034   0C0085E2           ADD      R0,R5,#+12
   \   00000038   01002DE9           PUSH     {R0}
   \   0000003C   B80F84E2           ADD      R0,R4,#+736
   \   00000040   010080E0           ADD      R0,R0,R1
   \   00000044   01002DE9           PUSH     {R0}
   \   00000048   0D1044E2           SUB      R1,R4,#+13
   \   0000004C   ........           B        ??Subroutine29_0
     72            return sbuf;
     73          }

   \                                 In segment CODE, align 4, keep-with-next
   \                     ?Subroutine29:
   \   00000000   0C0085E2           ADD      R0,R5,#+12
   \   00000004   01002DE9           PUSH     {R0}
   \   00000008   0D1044E2           SUB      R1,R4,#+13
   \   0000000C   B80F84E2           ADD      R0,R4,#+736
   \   00000010   0C0080E0           ADD      R0,R0,R12
   \   00000014   01002DE9           PUSH     {R0}
   \                     ??Subroutine29_0:
   \   00000018   050084E0           ADD      R0,R4,R5
   \   0000001C   1B0100EF           SWI      +283
   \   00000020   050084E0           ADD      R0,R4,R5
   \   00000024   18D08DE2           ADD      SP,SP,#+24
   \   00000028   3080BDE8           POP      {R4,R5,PC}       ;; return
     74          
     75          

   \                                 In segment CODE, align 4, keep-with-next
     76          char* url_messages_getConversations(int offset, int count, int extended, const char* fields)
     77          {
     78            snprintf(sbuf, 511, "%s/messages.getConversations?v=%s&access_token=%s&offset=%d&count=%d&extended=%d&fields=%s", API_DIR, API_VER, ACCESS_TOKEN, offset, count, extended, fields);
   \                     url_messages_getConversations:
   \   00000000   ........           LDR      R12,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   ........           LDR      R5,??DataTable51  ;; my_id
   \   0000000C   08002DE9           PUSH     {R3}
   \   00000010   04002DE9           PUSH     {R2}
   \   00000014   02002DE9           PUSH     {R1}
   \   00000018   01002DE9           PUSH     {R0}
   \   0000001C   834FA0E3           MOV      R4,#+524
   \   00000020   4D3E8CE2           ADD      R3,R12,#+1232
   \   00000024   6D2F8CE2           ADD      R2,R12,#+436
   \   00000028   ........           B        ?Subroutine29
     79            return sbuf;  
     80          }
     81          

   \                                 In segment CODE, align 4, keep-with-next
     82          char* url_users_get(const char* user_ids, const char* fields)
     83          {
     84            snprintf(sbuf, 1023, "%s/users.get?v=%s&access_token=%s&user_ids=%s&fields=%s", API_DIR, API_VER, ACCESS_TOKEN, user_ids, fields);
   \                     url_users_get:
   \   00000000   ........           LDR      R2,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   ........           LDR      R5,??DataTable51  ;; my_id
   \   0000000C   02002DE9           PUSH     {R1}
   \   00000010   01002DE9           PUSH     {R0}
   \   00000014   834FA0E3           MOV      R4,#+524
   \   00000018   4D3E82E2           ADD      R3,R2,#+1232
   \   0000001C   FF10A0E3           MOV      R1,#+255
   \   00000020   0C0085E2           ADD      R0,R5,#+12
   \   00000024   01002DE9           PUSH     {R0}
   \   00000028   C01F81E3           ORR      R1,R1,#0x300
   \   0000002C   B80F84E2           ADD      R0,R4,#+736
   \   00000030   020080E0           ADD      R0,R0,R2
   \   00000034   01002DE9           PUSH     {R0}
   \   00000038   842F82E2           ADD      R2,R2,#+528
   \   0000003C   ........           B        ??Subroutine30_0
     85            return sbuf;
     86          }

   \                                 In segment CODE, align 4, keep-with-next
   \                     ?Subroutine30:
   \   00000000   0C0085E2           ADD      R0,R5,#+12
   \   00000004   01002DE9           PUSH     {R0}
   \                     ??Subroutine30_0:
   \   00000008   050084E0           ADD      R0,R4,R5
   \   0000000C   1B0100EF           SWI      +283
   \   00000010   050084E0           ADD      R0,R4,R5
   \   00000014   10D08DE2           ADD      SP,SP,#+16
   \   00000018   3080BDE8           POP      {R4,R5,PC}       ;; return
     87          

   \                                 In segment CODE, align 4, keep-with-next
     88          char* url_messages_getHistory(int user_id, int count, int start_msg_id)
     89          {
     90            snprintf(sbuf, 511, "%s/messages.getHistory?access_token=%s&v=%s&user_id=%d&count=%d&start_message_id=%d", API_DIR, ACCESS_TOKEN, API_VER, user_id, count, start_msg_id);
   \                     url_messages_getHistory:
   \   00000000   ........           LDR      R12,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   ........           LDR      R5,??DataTable51  ;; my_id
   \   0000000C   04002DE9           PUSH     {R2}
   \   00000010   02002DE9           PUSH     {R1}
   \   00000014   01002DE9           PUSH     {R0}
   \   00000018   834FA0E3           MOV      R4,#+524
   \   0000001C   4D3E8CE2           ADD      R3,R12,#+1232
   \   00000020   922F8CE2           ADD      R2,R12,#+584
   \   00000024   B80F84E2           ADD      R0,R4,#+736
   \   00000028   0C0080E0           ADD      R0,R0,R12
   \   0000002C   01002DE9           PUSH     {R0}
   \   00000030   0D1044E2           SUB      R1,R4,#+13
   \   00000034   0C0085E2           ADD      R0,R5,#+12
   \   00000038                      REQUIRE ?Subroutine31
   \   00000038                      ;; // Fall through to label ?Subroutine31
     91            return sbuf;
     92          }
     93          

   \                                 In segment CODE, align 4, keep-with-next
     94          char* url_messages_deleteDialog(int user_id, int count)
     95          {
     96            snprintf(sbuf, 511, "%s/messages.deleteDialog?access_token=%s&v=%s&user_id=%d&count=%d", API_DIR, ACCESS_TOKEN, API_VER, user_id, count);
   \                     url_messages_deleteDialog:
   \   00000000   ........           LDR      R2,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   ........           LDR      R5,??DataTable51  ;; my_id
   \   0000000C   02002DE9           PUSH     {R1}
   \   00000010   01002DE9           PUSH     {R0}
   \   00000014   834FA0E3           MOV      R4,#+524
   \   00000018   4D3E82E2           ADD      R3,R2,#+1232
   \   0000001C   0D1044E2           SUB      R1,R4,#+13
   \   00000020   B80F84E2           ADD      R0,R4,#+736
   \   00000024   020080E0           ADD      R0,R0,R2
   \   00000028   01002DE9           PUSH     {R0}
   \   0000002C   A72F82E2           ADD      R2,R2,#+668
   \   00000030   ........           B        ?Subroutine30
     97            return sbuf;
     98          }
     99          

   \                                 In segment CODE, align 4, keep-with-next
    100          char* url_messages_markAsRead(char* message_ids, unsigned peer_id)
    101          {
    102            snprintf(sbuf, 1023, "%s/messages.markAsRead?v=%s&access_token=%s&message_ids=%s&peer_id=%d", API_DIR, API_VER, ACCESS_TOKEN, message_ids, peer_id);
   \                     url_messages_markAsRead:
   \   00000000   ........           LDR      R2,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   ........           LDR      R5,??DataTable51  ;; my_id
   \   0000000C   02002DE9           PUSH     {R1}
   \   00000010   01002DE9           PUSH     {R0}
   \   00000014   834FA0E3           MOV      R4,#+524
   \   00000018   4D3E82E2           ADD      R3,R2,#+1232
   \   0000001C   FF10A0E3           MOV      R1,#+255
   \   00000020   0C0085E2           ADD      R0,R5,#+12
   \   00000024   01002DE9           PUSH     {R0}
   \   00000028   C01F81E3           ORR      R1,R1,#0x300
   \   0000002C   B80F84E2           ADD      R0,R4,#+736
   \   00000030   020080E0           ADD      R0,R0,R2
   \   00000034   01002DE9           PUSH     {R0}
   \   00000038   B82F82E2           ADD      R2,R2,#+736
   \   0000003C   ........           B        ??Subroutine30_0
    103            return sbuf;  
    104          }
    105          

   \                                 In segment CODE, align 4, keep-with-next
    106          char* url_friends_get(int count, int offset, char* order, char* fields)
    107          {
    108            snprintf(sbuf, 511, "%s/friends.get?v=%s&access_token=%s&count=%d&offset=%d&order=%s&fields=%s", API_DIR, API_VER, ACCESS_TOKEN, count, offset, order, fields);
   \                     url_friends_get:
   \   00000000   ........           LDR      R12,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   ........           LDR      R5,??DataTable51  ;; my_id
   \   0000000C   08002DE9           PUSH     {R3}
   \   00000010   04002DE9           PUSH     {R2}
   \   00000014   02002DE9           PUSH     {R1}
   \   00000018   01002DE9           PUSH     {R0}
   \   0000001C   834FA0E3           MOV      R4,#+524
   \   00000020   4D3E8CE2           ADD      R3,R12,#+1232
   \   00000024   CA2F8CE2           ADD      R2,R12,#+808
   \   00000028                      REQUIRE ?Subroutine29
   \   00000028                      ;; // Fall through to label ?Subroutine29
    109            return sbuf;  
    110          }
    111          

   \                                 In segment CODE, align 4, keep-with-next
    112          char* url_messages_send(int user_id, char* message)
    113          {
   \                     url_messages_send:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
    114            char* msg=URL_reencode_escapes(message);//кодируем строку
    115            snprintf(sbuf, 511, "v=%s&access_token=%s&user_id=%d&message=%s", API_VER, ACCESS_TOKEN, user_id, msg);
   \   00000004   ........           LDR      R7,??DataTable51  ;; my_id
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   0100A0E1           MOV      R0,R1
   \   00000010   ........           _BLF     URL_reencode_escapes,??URL_reencode_escapes??rA
   \   00000014   0050A0E1           MOV      R5,R0
   \   00000018   ........           LDR      R0,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   0000001C   0510A0E1           MOV      R1,R5
   \   00000020   02002DE9           PUSH     {R1}
   \   00000024   10002DE9           PUSH     {R4}
   \   00000028   836FA0E3           MOV      R6,#+524
   \   0000002C   0C1087E2           ADD      R1,R7,#+12
   \   00000030   02002DE9           PUSH     {R1}
   \   00000034   DD2F80E2           ADD      R2,R0,#+884
   \   00000038   B81F86E2           ADD      R1,R6,#+736
   \   0000003C   003081E0           ADD      R3,R1,R0
   \   00000040   0D1046E2           SUB      R1,R6,#+13
   \   00000044   070086E0           ADD      R0,R6,R7
   \   00000048   1B0100EF           SWI      +283
    116            mfree(msg);
   \   0000004C   0500A0E1           MOV      R0,R5
   \   00000050   150000EF           SWI      +21
    117            return sbuf;
   \   00000054   070086E0           ADD      R0,R6,R7
   \   00000058   FE80BDE8           POP      {R1-R7,PC}       ;; return
    118          }
    119          

   \                                 In segment CODE, align 4, keep-with-next
    120          char* url_groups_get(int offset, int count)//список груп+инфо
    121          {
    122            snprintf(sbuf, 511, "%s/groups.get?v=%s&access_token=%s&offset=%d&count=%d&extended=1", API_DIR, API_VER, ACCESS_TOKEN, offset, count);
   \                     url_groups_get:
   \   00000000   ........           LDR      R2,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   ........           LDR      R5,??DataTable51  ;; my_id
   \   0000000C   02002DE9           PUSH     {R1}
   \   00000010   01002DE9           PUSH     {R0}
   \   00000014   834FA0E3           MOV      R4,#+524
   \   00000018   4D3E82E2           ADD      R3,R2,#+1232
   \   0000001C   0D1044E2           SUB      R1,R4,#+13
   \   00000020   0C0085E2           ADD      R0,R5,#+12
   \   00000024   01002DE9           PUSH     {R0}
   \   00000028   B80F84E2           ADD      R0,R4,#+736
   \   0000002C   020080E0           ADD      R0,R0,R2
   \   00000030   01002DE9           PUSH     {R0}
   \   00000034   E82F82E2           ADD      R2,R2,#+928
   \   00000038   ........           B        ??Subroutine30_0
    123            return sbuf;
    124          }
    125          

   \                                 In segment CODE, align 4, keep-with-next
    126          char* url_groups_getById(const char* group_ids, const char* fields)//инфо о группе
    127          {
    128            snprintf(sbuf, 511, "%s/groups.getById?v=%s&access_token=%s&group_ids=%s&fields=%s", API_DIR, API_VER, ACCESS_TOKEN, group_ids, fields);
   \                     url_groups_getById:
   \   00000000   ........           LDR      R2,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   ........           LDR      R5,??DataTable51  ;; my_id
   \   0000000C   02002DE9           PUSH     {R1}
   \   00000010   01002DE9           PUSH     {R0}
   \   00000014   834FA0E3           MOV      R4,#+524
   \   00000018   4D3E82E2           ADD      R3,R2,#+1232
   \   0000001C   0D1044E2           SUB      R1,R4,#+13
   \   00000020   0C0085E2           ADD      R0,R5,#+12
   \   00000024   01002DE9           PUSH     {R0}
   \   00000028   B80F84E2           ADD      R0,R4,#+736
   \   0000002C   020080E0           ADD      R0,R0,R2
   \   00000030   01002DE9           PUSH     {R0}
   \   00000034   F92F82E2           ADD      R2,R2,#+996
   \   00000038   ........           B        ??Subroutine30_0
    129            return sbuf;  
    130          }
    131          

   \                                 In segment CODE, align 4, keep-with-next
    132          char* url_wall_get(int owner_id, int offset, int extended)
    133          {
    134            snprintf(sbuf, 511, "%s/wall.get?v=%s&access_token=%s&owner_id=%d&count=1&offset=%d&extended=%d", API_DIR, API_VER, ACCESS_TOKEN, owner_id, offset, extended);
   \                     url_wall_get:
   \   00000000   ........           LDR      R12,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   ........           LDR      R5,??DataTable51  ;; my_id
   \   0000000C   04002DE9           PUSH     {R2}
   \   00000010   02002DE9           PUSH     {R1}
   \   00000014   01002DE9           PUSH     {R0}
   \   00000018   834FA0E3           MOV      R4,#+524
   \   0000001C   4D3E8CE2           ADD      R3,R12,#+1232
   \   00000020   0D1044E2           SUB      R1,R4,#+13
   \   00000024   0C0085E2           ADD      R0,R5,#+12
   \   00000028   01002DE9           PUSH     {R0}
   \   0000002C   B80F84E2           ADD      R0,R4,#+736
   \   00000030   0C0080E0           ADD      R0,R0,R12
   \   00000034   01002DE9           PUSH     {R0}
   \   00000038   860F84E2           ADD      R0,R4,#+536
   \   0000003C   0C2080E0           ADD      R2,R0,R12
   \   00000040   ........           B        ??Subroutine31_0
    135            return sbuf;
    136          }
    137          
    138          //Вариант отправкис помощью скрипта. Требует маскировки двойных кавычек в сообщении. Проще вызывать хранимые процедуры.
    139          /*char* execute_send(int user_id, char* message)
    140          {
    141            char* msg=URL_reencode_escapes(message);//кодируем строку
    142            snprintf(sbuf, 511, "v=%s&access_token=%s&code="
    143                     "var id=API.messages.send({\"user_id\":%d, \"message\":\"%s\"});"
    144                     "return API.messages.getById({\"message_ids\":id});"
    145                     ,API_VER, ACCESS_TOKEN, user_id, msg);
    146            mfree(msg);
    147            return sbuf;
    148          } */
    149          
    150          //хранимые процедуры

   \                                 In segment CODE, align 4, keep-with-next
    151          char* url_execute_getHistory(int user_id, int count)
    152          {
    153            snprintf(sbuf, 511, "%s/execute.getHistory.xml?access_token=%s&v=%s&user_id=%d&count=%d&func_v=1", API_DIR, ACCESS_TOKEN, API_VER, user_id, count);
   \                     url_execute_getHistory:
   \   00000000   ........           LDR      R2,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   ........           LDR      R5,??DataTable51  ;; my_id
   \   0000000C   02002DE9           PUSH     {R1}
   \   00000010   01002DE9           PUSH     {R0}
   \   00000014   834FA0E3           MOV      R4,#+524
   \   00000018   4D3E82E2           ADD      R3,R2,#+1232
   \   0000001C   0D1044E2           SUB      R1,R4,#+13
   \   00000020   B80F84E2           ADD      R0,R4,#+736
   \   00000024   020080E0           ADD      R0,R0,R2
   \   00000028   01002DE9           PUSH     {R0}
   \   0000002C                      REQUIRE ?Subroutine30
   \   0000002C                      ;; // Fall through to label ?Subroutine30
    154            return sbuf;
    155          }
    156          
    157          //через post

   \                                 In segment CODE, align 4, keep-with-next
    158          char* url_execute_sendAndGet(int user_id, char* message, int last_msg_id)
    159          {
    160            //char* msg=URL_reencode_escapes(message);//кодируем строку  
    161            snprintf(sbuf, 511, "access_token=%s&v=%s&func_v=1&user_id=%d&last_message_id=%d&message=%s", ACCESS_TOKEN, API_VER, user_id, last_msg_id, message);
   \                     url_execute_sendAndGet:
   \   00000000   ........           LDR      R12,??DataTable30  ;; `?<Constant "%s/execute.getHistory...">`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   ........           LDR      R5,??DataTable51  ;; my_id
   \   0000000C   02002DE9           PUSH     {R1}
   \   00000010   04002DE9           PUSH     {R2}
   \   00000014   01002DE9           PUSH     {R0}
   \   00000018   834FA0E3           MOV      R4,#+524
   \   0000001C   0C3085E2           ADD      R3,R5,#+12
   \   00000020   472E8CE2           ADD      R2,R12,#+1136
   \   00000024   B80F84E2           ADD      R0,R4,#+736
   \   00000028   0C0080E0           ADD      R0,R0,R12
   \   0000002C   01002DE9           PUSH     {R0}
   \   00000030   0D1044E2           SUB      R1,R4,#+13
   \   00000034   ........           B        ??Subroutine30_0
    162            //mfree(msg);
    163            return sbuf;
    164          }
    165          
    166          //******************************************************************************
    167          

   \                                 In segment CODE, align 4, keep-with-next
    168          static int __parse_obj_Error(cJSON* j_error)
    169          {   
   \                     __parse_obj_Error:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
    170            int error = 0;
    171            
    172            cJSON* j_item = cJSON_GetObjectItem(j_error, "error_code");
   \   00000004   40609FE5           LDR      R6,??__parse_obj_Error_0  ;; `?<Constant "error_code">`
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   0050A0E3           MOV      R5,#+0
   \   00000010   0610A0E1           MOV      R1,R6
   \   00000014   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    173            if (j_item)
   \   00000018   000050E3           CMP      R0,#+0
    174              error = j_item->valueint;
   \   0000001C   14509015           LDRNE    R5,[R0, #+20]
    175            
    176            j_item = cJSON_GetObjectItem(j_error, "error_msg");
   \   00000020   0C1086E2           ADD      R1,R6,#+12
   \   00000024   0400A0E1           MOV      R0,R4
   \   00000028   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    177            if (j_item)
   \   0000002C   000050E3           CMP      R0,#+0
   \   00000030   0300000A           BEQ      ??__parse_obj_Error_1
    178              strncpy(err_msg, j_item->valuestring, 255);     
   \   00000034   101090E5           LDR      R1,[R0, #+16]
   \   00000038   10009FE5           LDR      R0,??__parse_obj_Error_0+0x4  ;; my_id + 268
   \   0000003C   FF20A0E3           MOV      R2,#+255
   \   00000040   160100EF           SWI      +278
    179          
    180            return error;
   \                     ??__parse_obj_Error_1:
   \   00000044   0500A0E1           MOV      R0,R5
   \   00000048   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??__parse_obj_Error_0:
   \   0000004C   ........           DC32     `?<Constant "error_code">`
   \   00000050   ........           DC32     my_id + 268
    181          }
    182          
    183          static void __parse_obj_attachments(cJSON* json, struct list_head *attachments)
    184          {
    185            if (cJSON_GetArraySize(json) > 0)
    186            {
    187              cJSON* i = NULL;  
    188              cJSON_ArrayForEach(i, json)
    189              {
    190                cJSON *j_item = cJSON_GetObjectItem(i, t_type);
    191                if (j_item)
    192                {
    193                  VkAttach *attach = malloc(sizeof(VkAttach));
    194                  INIT_LIST_HEAD(&attach->list);
    195                  attach->type = 0;
    196                  
    197                  if (strcmp(j_item->valuestring, "photo") == 0)
    198                      attach->type = 1;
    199                  list_add_tail(&attach->list, attachments);
    200                }
    201              }
    202            }
    203          }
    204          

   \                                 In segment CODE, align 4, keep-with-next
    205          static void __parse_obj_Message(cJSON* json, struct message_args *msg_args, struct list_head *attachments)
    206          {
   \                     __parse_obj_Message:
   \   00000000   F0432DE9           PUSH     {R4-R9,LR}
    207            msg_args->date = 0;
    208            msg_args->from_id = 0;
    209            msg_args->peer_id = 0;
    210            msg_args->id = 0;
    211            msg_args->out = 0;
    212            msg_args->text = 0;
    213            
    214            cJSON *j_item = cJSON_GetObjectItem(json, "date");
   \   00000004   ........           LDR      R8,??DataTable36  ;; t_id
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   0150A0E1           MOV      R5,R1
   \   00000010   0260A0E1           MOV      R6,R2
   \   00000014   0070A0E3           MOV      R7,#+0
   \   00000018   047085E5           STR      R7,[R5, #+4]
   \   0000001C   087085E5           STR      R7,[R5, #+8]
   \   00000020   0C7085E5           STR      R7,[R5, #+12]
   \   00000024   007085E5           STR      R7,[R5, #+0]
   \   00000028   147085E5           STR      R7,[R5, #+20]
   \   0000002C   107085E5           STR      R7,[R5, #+16]
   \   00000030   581088E2           ADD      R1,R8,#+88
   \   00000034   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    215            if (j_item)
   \   00000038   000050E3           CMP      R0,#+0
    216              msg_args->date = j_item->valueint; 
   \   0000003C   14009015           LDRNE    R0,[R0, #+20]
    217            
    218            j_item = cJSON_GetObjectItem(json, "from_id");
   \   00000040   601088E2           ADD      R1,R8,#+96
   \   00000044   04008515           STRNE    R0,[R5, #+4]
   \   00000048   0400A0E1           MOV      R0,R4
   \   0000004C   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    219            if (j_item)
   \   00000050   000050E3           CMP      R0,#+0
    220              msg_args->from_id = j_item->valueint;
   \   00000054   14009015           LDRNE    R0,[R0, #+20]
    221            
    222            j_item = cJSON_GetObjectItem(json, "peer_id");
   \   00000058   681088E2           ADD      R1,R8,#+104
   \   0000005C   08008515           STRNE    R0,[R5, #+8]
   \   00000060   0400A0E1           MOV      R0,R4
   \   00000064   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    223            if (j_item)
   \   00000068   000050E3           CMP      R0,#+0
    224              msg_args->peer_id = j_item->valueint;
   \   0000006C   14009015           LDRNE    R0,[R0, #+20]
    225            
    226            j_item = cJSON_GetObjectItem(json, t_id);
   \   00000070   0810A0E1           MOV      R1,R8
   \   00000074   0C008515           STRNE    R0,[R5, #+12]
   \   00000078   0400A0E1           MOV      R0,R4
   \   0000007C   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    227            if (j_item)
   \   00000080   000050E3           CMP      R0,#+0
    228              msg_args->id = j_item->valueint;
   \   00000084   14009015           LDRNE    R0,[R0, #+20]
    229            
    230            j_item = cJSON_GetObjectItem(json, "text");
   \   00000088   701088E2           ADD      R1,R8,#+112
   \   0000008C   00008515           STRNE    R0,[R5, #+0]
   \   00000090   0400A0E1           MOV      R0,R4
   \   00000094   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    231            if (j_item)
   \   00000098   000050E3           CMP      R0,#+0
    232              msg_args->text = j_item->valuestring;
   \   0000009C   10009015           LDRNE    R0,[R0, #+16]
    233            
    234            j_item = cJSON_GetObjectItem(json, "out");
   \   000000A0   291F8FE2           ADR      R1,??__parse_obj_Message_0  ;; "out"
   \   000000A4   10008515           STRNE    R0,[R5, #+16]
   \   000000A8   0400A0E1           MOV      R0,R4
   \   000000AC   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    235            if (j_item)
   \   000000B0   000050E3           CMP      R0,#+0
    236              msg_args->out = j_item->valueint;
   \   000000B4   14009015           LDRNE    R0,[R0, #+20]
    237            
    238              j_item = cJSON_GetObjectItem(json, "attachments");
   \   000000B8   781088E2           ADD      R1,R8,#+120
   \   000000BC   14008515           STRNE    R0,[R5, #+20]
   \   000000C0   0400A0E1           MOV      R0,R4
   \   000000C4   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   000000C8   0040B0E1           MOVS     R4,R0
    239            if (j_item)
   \   000000CC   F083BD08           POPEQ    {R4-R9,PC}
    240              __parse_obj_attachments(j_item, attachments);
   \   000000D0   ........           _BLF     cJSON_GetArraySize,??cJSON_GetArraySize??rA
   \   000000D4   010050E3           CMP      R0,#+1
   \   000000D8   F083BDB8           POPLT    {R4-R9,PC}
   \   000000DC   084094E5           LDR      R4,[R4, #+8]
   \   000000E0   160000EA           B        ??__parse_obj_Message_1
   \                     ??__parse_obj_Message_2:
   \   000000E4   D01088E2           ADD      R1,R8,#+208
   \   000000E8   0400A0E1           MOV      R0,R4
   \   000000EC   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   000000F0   0050B0E1           MOVS     R5,R0
   \   000000F4   1000000A           BEQ      ??__parse_obj_Message_3
   \   000000F8   0C00A0E3           MOV      R0,#+12
   \   000000FC   140000EF           SWI      +20
   \   00000100   0090A0E1           MOV      R9,R0
   \   00000104   009089E5           STR      R9,[R9, #+0]
   \   00000108   049089E5           STR      R9,[R9, #+4]
   \   0000010C   087089E5           STR      R7,[R9, #+8]
   \   00000110   100095E5           LDR      R0,[R5, #+16]
   \   00000114   501088E2           ADD      R1,R8,#+80
   \   00000118   190000EF           SWI      +25
   \   0000011C   000050E3           CMP      R0,#+0
   \   00000120   0100A003           MOVEQ    R0,#+1
   \   00000124   08008905           STREQ    R0,[R9, #+8]
   \   00000128   040096E5           LDR      R0,[R6, #+4]
   \   0000012C   049086E5           STR      R9,[R6, #+4]
   \   00000130   006089E5           STR      R6,[R9, #+0]
   \   00000134   040089E5           STR      R0,[R9, #+4]
   \   00000138   009080E5           STR      R9,[R0, #+0]
   \                     ??__parse_obj_Message_3:
   \   0000013C   004094E5           LDR      R4,[R4, #+0]
   \                     ??__parse_obj_Message_1:
   \   00000140   000054E3           CMP      R4,#+0
   \   00000144   E6FFFF1A           BNE      ??__parse_obj_Message_2
    241          }
   \   00000148   F083BDE8           POP      {R4-R9,PC}       ;; return
   \                     ??__parse_obj_Message_0:
   \   0000014C   6F757400           DC8      "out"
    242          

   \                                 In segment CODE, align 4, keep-with-next
    243          static void __parse_obj_User(cJSON* json, struct user_args *args)
    244          {
   \                     __parse_obj_User:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
    245            args->id = 0;
    246            args->first_name = 0;
    247            args->last_name = 0;
    248            args->deactivated = 0;
    249            args->is_closed = 0;
    250            args->can_access_closed = 0;
    251            args->online = 0;
    252            args->has_photo = 0;
    253            args->photo_50 = 0;
    254            
    255            cJSON* j_item = cJSON_GetObjectItem(json, t_id);
   \   00000004   ........           LDR      R6,??DataTable36  ;; t_id
   \   00000008   0050A0E1           MOV      R5,R0
   \   0000000C   0140A0E1           MOV      R4,R1
   \   00000010   0000A0E3           MOV      R0,#+0
   \   00000014   000084E5           STR      R0,[R4, #+0]
   \   00000018   040084E5           STR      R0,[R4, #+4]
   \   0000001C   080084E5           STR      R0,[R4, #+8]
   \   00000020   0C0084E5           STR      R0,[R4, #+12]
   \   00000024   100084E5           STR      R0,[R4, #+16]
   \   00000028   140084E5           STR      R0,[R4, #+20]
   \   0000002C   180084E5           STR      R0,[R4, #+24]
   \   00000030   240084E5           STR      R0,[R4, #+36]
   \   00000034   200084E5           STR      R0,[R4, #+32]
   \   00000038   0610A0E1           MOV      R1,R6
   \   0000003C   0500A0E1           MOV      R0,R5
   \   00000040   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    256            if (j_item)
   \   00000044   000050E3           CMP      R0,#+0
    257              args->id = j_item->valueint;           
   \   00000048   14009015           LDRNE    R0,[R0, #+20]
    258                    
    259            j_item = cJSON_GetObjectItem(json, "first_name");
   \   0000004C   841086E2           ADD      R1,R6,#+132
   \   00000050   00008415           STRNE    R0,[R4, #+0]
   \   00000054   0500A0E1           MOV      R0,R5
   \   00000058   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    260            if (j_item)
   \   0000005C   000050E3           CMP      R0,#+0
    261              args->first_name = j_item->valuestring;
   \   00000060   10009015           LDRNE    R0,[R0, #+16]
    262                    
    263            j_item = cJSON_GetObjectItem(json, "last_name");
   \   00000064   901086E2           ADD      R1,R6,#+144
   \   00000068   04008415           STRNE    R0,[R4, #+4]
   \   0000006C   0500A0E1           MOV      R0,R5
   \   00000070   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    264            if (j_item)
   \   00000074   000050E3           CMP      R0,#+0
    265              args->last_name = j_item->valuestring;  
   \   00000078   10009015           LDRNE    R0,[R0, #+16]
    266          
    267            j_item = cJSON_GetObjectItem(json, t_deactivated);
    268            if (j_item)
   \   0000007C   AC1086E2           ADD      R1,R6,#+172
   \   00000080   08008415           STRNE    R0,[R4, #+8]
   \   00000084   0500A0E1           MOV      R0,R5
   \   00000088   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   0000008C   000050E3           CMP      R0,#+0
    269              args->deactivated = 1;//string: "deleted", "banned"
   \   00000090   0100A013           MOVNE    R0,#+1
   \   00000094   0C008415           STRNE    R0,[R4, #+12]
    270            
    271            j_item = cJSON_GetObjectItem(json, t_photo_50);
   \   00000098   C41086E2           ADD      R1,R6,#+196
   \   0000009C   0500A0E1           MOV      R0,R5
   \   000000A0   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    272            if (j_item)
   \   000000A4   000050E3           CMP      R0,#+0
    273              args->photo_50 = j_item->valuestring;
   \   000000A8   10009015           LDRNE    R0,[R0, #+16]
    274          
    275             j_item = cJSON_GetObjectItem(json, t_has_photo);
   \   000000AC   B81086E2           ADD      R1,R6,#+184
   \   000000B0   20008415           STRNE    R0,[R4, #+32]
   \   000000B4   0500A0E1           MOV      R0,R5
   \   000000B8   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    276            if (j_item)
   \   000000BC   000050E3           CMP      R0,#+0
    277              args->has_photo = j_item->valueint; 
   \   000000C0   14009015           LDRNE    R0,[R0, #+20]
    278          
    279            j_item = cJSON_GetObjectItem(json, "friend_status");
   \   000000C4   9C1086E2           ADD      R1,R6,#+156
   \   000000C8   24008415           STRNE    R0,[R4, #+36]
   \   000000CC   0500A0E1           MOV      R0,R5
   \   000000D0   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    280            if (j_item)
   \   000000D4   000050E3           CMP      R0,#+0
    281              args->friend_status = j_item->valueint; 
   \   000000D8   14009015           LDRNE    R0,[R0, #+20]
    282            
    283            j_item = cJSON_GetObjectItem(json, "online");
   \   000000DC   041086E2           ADD      R1,R6,#+4
   \   000000E0   1C008415           STRNE    R0,[R4, #+28]
   \   000000E4   0500A0E1           MOV      R0,R5
   \   000000E8   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    284            if (j_item)
   \   000000EC   000050E3           CMP      R0,#+0
    285              args->online = j_item->valueint;  
   \   000000F0   14009015           LDRNE    R0,[R0, #+20]
   \   000000F4   18008415           STRNE    R0,[R4, #+24]
    286          }
   \   000000F8   7080BDE8           POP      {R4-R6,PC}       ;; return
    287          

   \                                 In segment CODE, align 4, keep-with-next
    288          static void __parse_obj_profiles(cJSON *json)
    289          {
   \                     __parse_obj_profiles:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   28D04DE2           SUB      SP,SP,#+40
   \   00000008   0040A0E1           MOV      R4,R0
    290            if (cJSON_GetArraySize(json) > 0)
   \   0000000C   ........           _BLF     cJSON_GetArraySize,??cJSON_GetArraySize??rA
   \   00000010   010050E3           CMP      R0,#+1
   \   00000014   200000BA           BLT      ??__parse_obj_profiles_0
    291            {
    292              cJSON* i = NULL;
    293              
    294              cJSON_ArrayForEach(i, json)
   \   00000018   000054E3           CMP      R4,#+0
   \   0000001C   1E00000A           BEQ      ??__parse_obj_profiles_0
   \   00000020   084094E5           LDR      R4,[R4, #+8]
   \   00000024   120000EA           B        ??__parse_obj_profiles_1
    295              {
    296                struct user_args res;
    297                struct list_head *list;
    298                
    299                __parse_obj_User(i, &res);
    300                
    301                if (res.friend_status == 3)
    302                  list = &friends;
    303                else
    304                  list = &profiles;
    305                
    306                if (find_User(list, res.id) == 0)
   \                     ??__parse_obj_profiles_2:
   \   00000028   00109DE5           LDR      R1,[SP, #+0]
   \   0000002C   0500A0E1           MOV      R0,R5
   \   00000030   ........           _BLF     find_User,??find_User??rA
   \   00000034   000050E3           CMP      R0,#+0
   \   00000038   0C00001A           BNE      ??__parse_obj_profiles_3
    307                {
    308                  VkUser *user = new_User(&res);
   \   0000003C   0D00A0E1           MOV      R0,SP
   \   00000040   ........           _BLF     new_User,??new_User??rA
   \   00000044   0060A0E1           MOV      R6,R0
    309                  list_add(&user->list, list);
   \   00000048   000095E5           LDR      R0,[R5, #+0]
   \   0000004C   046080E5           STR      R6,[R0, #+4]
   \   00000050   000086E5           STR      R0,[R6, #+0]
    310                  VkDialog *dialog = FindDialog(&dialogs, user->id);
   \   00000054   ........           LDR      R0,??DataTable57  ;; dialogs
   \   00000058   045086E5           STR      R5,[R6, #+4]
   \   0000005C   006085E5           STR      R6,[R5, #+0]
   \   00000060   081096E5           LDR      R1,[R6, #+8]
   \   00000064   ........           _BLF     FindDialog,??FindDialog??rA
    311                  if (dialog)
   \   00000068   000050E3           CMP      R0,#+0
    312                    dialog->user = user;
   \   0000006C   1C608015           STRNE    R6,[R0, #+28]
    313                }
   \                     ??__parse_obj_profiles_3:
   \   00000070   004094E5           LDR      R4,[R4, #+0]
   \                     ??__parse_obj_profiles_1:
   \   00000074   000054E3           CMP      R4,#+0
   \   00000078   0700000A           BEQ      ??__parse_obj_profiles_0
   \   0000007C   0D10A0E1           MOV      R1,SP
   \   00000080   0400A0E1           MOV      R0,R4
   \   00000084   ........           BL       __parse_obj_User
   \   00000088   1C009DE5           LDR      R0,[SP, #+28]
   \   0000008C   030050E3           CMP      R0,#+3
   \   00000090   ........           LDRNE    R5,??DataTable43  ;; profiles
   \   00000094   08509F05           LDREQ    R5,??__parse_obj_profiles_4  ;; friends
   \   00000098   E2FFFFEA           B        ??__parse_obj_profiles_2
    314              }
    315            } 
    316          }
   \                     ??__parse_obj_profiles_0:
   \   0000009C   28D08DE2           ADD      SP,SP,#+40       ;; stack cleaning
   \   000000A0   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??__parse_obj_profiles_4:
   \   000000A4   ........           DC32     friends
    317          

   \                                 In segment CODE, align 4, keep-with-next
    318          static void __parse_obj_Group(cJSON* json, struct group_args *args)
    319          {
   \                     __parse_obj_Group:
   \   00000000   F0432DE9           PUSH     {R4-R9,LR}
    320            args->id = 0;
    321            args->name = 0;
    322            args->screen_name = 0;
    323            args->is_closed = 0;
    324            args->deactivated = 0;
    325            args->is_member=0;
    326            args->type = 0;
    327            args->has_photo = 0;  
    328            args->photo_50 = 0;
    329            
    330            cJSON* j_item = cJSON_GetObjectItem(json, t_id);
   \   00000004   ........           LDR      R6,??DataTable36  ;; t_id
   \   00000008   0050A0E1           MOV      R5,R0
   \   0000000C   0140A0E1           MOV      R4,R1
   \   00000010   0070A0E3           MOV      R7,#+0
   \   00000014   087084E5           STR      R7,[R4, #+8]
   \   00000018   0C7084E5           STR      R7,[R4, #+12]
   \   0000001C   107084E5           STR      R7,[R4, #+16]
   \   00000020   147084E5           STR      R7,[R4, #+20]
   \   00000024   187084E5           STR      R7,[R4, #+24]
   \   00000028   207084E5           STR      R7,[R4, #+32]
   \   0000002C   1C7084E5           STR      R7,[R4, #+28]
   \   00000030   247084E5           STR      R7,[R4, #+36]
   \   00000034   287084E5           STR      R7,[R4, #+40]
   \   00000038   0610A0E1           MOV      R1,R6
   \   0000003C   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    331            if (j_item)
   \   00000040   000050E3           CMP      R0,#+0
    332              //здесь id положительный почему-то - делаем отрицательным
    333              args->id = -j_item->valueint;
   \   00000044   14009015           LDRNE    R0,[R0, #+20]
    334                    
    335            j_item = cJSON_GetObjectItem(json, "name");
   \   00000048   0C1086E2           ADD      R1,R6,#+12
   \   0000004C   00006012           RSBNE    R0,R0,#+0
   \   00000050   08008415           STRNE    R0,[R4, #+8]
   \   00000054   0500A0E1           MOV      R0,R5
   \   00000058   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    336            if (j_item)
   \   0000005C   000050E3           CMP      R0,#+0
    337              args->name = j_item->valuestring;
   \   00000060   10009015           LDRNE    R0,[R0, #+16]
    338                    
    339            j_item = cJSON_GetObjectItem(json, "screen_name");
   \   00000064   141086E2           ADD      R1,R6,#+20
   \   00000068   0C008415           STRNE    R0,[R4, #+12]
   \   0000006C   0500A0E1           MOV      R0,R5
   \   00000070   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    340            if (j_item)
   \   00000074   000050E3           CMP      R0,#+0
    341              args->screen_name = j_item->valuestring;
   \   00000078   10009015           LDRNE    R0,[R0, #+16]
    342          
    343            j_item = cJSON_GetObjectItem(json, "is_closed");
   \   0000007C   201086E2           ADD      R1,R6,#+32
   \   00000080   10008415           STRNE    R0,[R4, #+16]
   \   00000084   0500A0E1           MOV      R0,R5
   \   00000088   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    344            if (j_item)
   \   0000008C   000050E3           CMP      R0,#+0
    345              args->is_closed = j_item->valueint;
   \   00000090   14009015           LDRNE    R0,[R0, #+20]
    346            
    347            j_item = cJSON_GetObjectItem(json, t_deactivated);
    348            if (j_item)
   \   00000094   0180A0E3           MOV      R8,#+1
   \   00000098   14008415           STRNE    R0,[R4, #+20]
   \   0000009C   AC1086E2           ADD      R1,R6,#+172
   \   000000A0   0500A0E1           MOV      R0,R5
   \   000000A4   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   000000A8   000050E3           CMP      R0,#+0
    349              args->deactivated = 1;//string: "deleted", "banned"
   \   000000AC   18808415           STRNE    R8,[R4, #+24]
    350            
    351            j_item = cJSON_GetObjectItem(json, t_type);
   \   000000B0   D01086E2           ADD      R1,R6,#+208
   \   000000B4   0500A0E1           MOV      R0,R5
   \   000000B8   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   000000BC   0090B0E1           MOVS     R9,R0
    352            if (j_item)
   \   000000C0   1100000A           BEQ      ??__parse_obj_Group_0
    353            {
    354              if (strcmp(j_item->valuestring, "group") == 0)
   \   000000C4   100099E5           LDR      R0,[R9, #+16]
   \   000000C8   3C1086E2           ADD      R1,R6,#+60
   \   000000CC   190000EF           SWI      +25
   \   000000D0   000050E3           CMP      R0,#+0
    355                args->type = 0;
   \   000000D4   1C708405           STREQ    R7,[R4, #+28]
   \   000000D8   0B00000A           BEQ      ??__parse_obj_Group_0
    356              else
    357                if (strcmp(j_item->valuestring, "page") == 0)
   \   000000DC   100099E5           LDR      R0,[R9, #+16]
   \   000000E0   341086E2           ADD      R1,R6,#+52
   \   000000E4   190000EF           SWI      +25
   \   000000E8   000050E3           CMP      R0,#+0
    358                  args->type = 1;
   \   000000EC   1C808405           STREQ    R8,[R4, #+28]
   \   000000F0   0500000A           BEQ      ??__parse_obj_Group_0
    359                else
    360                  if (strcmp(j_item->valuestring, "event") == 0)
   \   000000F4   100099E5           LDR      R0,[R9, #+16]
   \   000000F8   2C1086E2           ADD      R1,R6,#+44
   \   000000FC   190000EF           SWI      +25
   \   00000100   000050E3           CMP      R0,#+0
    361                    args->type = 2;
   \   00000104   0200A003           MOVEQ    R0,#+2
   \   00000108   1C008405           STREQ    R0,[R4, #+28]
    362            }
    363            
    364            j_item = cJSON_GetObjectItem(json, "is_member");
   \                     ??__parse_obj_Group_0:
   \   0000010C   441086E2           ADD      R1,R6,#+68
   \   00000110   0500A0E1           MOV      R0,R5
   \   00000114   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    365            if (j_item)
   \   00000118   000050E3           CMP      R0,#+0
    366              args->is_member = j_item->valueint;
   \   0000011C   14009015           LDRNE    R0,[R0, #+20]
    367            
    368            j_item = cJSON_GetObjectItem(json, t_has_photo);
   \   00000120   B81086E2           ADD      R1,R6,#+184
   \   00000124   20008415           STRNE    R0,[R4, #+32]
   \   00000128   0500A0E1           MOV      R0,R5
   \   0000012C   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    369            if (j_item)
   \   00000130   000050E3           CMP      R0,#+0
    370              args->has_photo = j_item->valueint;
   \   00000134   14009015           LDRNE    R0,[R0, #+20]
    371            
    372            j_item = cJSON_GetObjectItem(json, t_photo_50);
   \   00000138   C41086E2           ADD      R1,R6,#+196
   \   0000013C   24008415           STRNE    R0,[R4, #+36]
   \   00000140   0500A0E1           MOV      R0,R5
   \   00000144   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    373            if (j_item)
   \   00000148   000050E3           CMP      R0,#+0
    374              args->photo_50 = j_item->valuestring;  
   \   0000014C   10009015           LDRNE    R0,[R0, #+16]
   \   00000150   28008415           STRNE    R0,[R4, #+40]
    375          }
   \   00000154   F083BDE8           POP      {R4-R9,PC}       ;; return
    376          

   \                                 In segment CODE, align 4, keep-with-next
    377          static void __parse_obj_groups(cJSON *j_items)
    378          {
   \                     __parse_obj_groups:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   2CD04DE2           SUB      SP,SP,#+44
   \   00000008   0040A0E1           MOV      R4,R0
    379            if (cJSON_GetArraySize(j_items) > 0)
   \   0000000C   ........           _BLF     cJSON_GetArraySize,??cJSON_GetArraySize??rA
   \   00000010   010050E3           CMP      R0,#+1
   \   00000014   250000BA           BLT      ??__parse_obj_groups_0
    380            {
    381              cJSON* i = NULL;
    382              
    383              cJSON_ArrayForEach(i, j_items)
   \   00000018   000054E3           CMP      R4,#+0
   \   0000001C   2300000A           BEQ      ??__parse_obj_groups_0
   \   00000020   084094E5           LDR      R4,[R4, #+8]
   \   00000024   170000EA           B        ??__parse_obj_groups_1
    384              {
    385                struct group_args res;
    386                struct list_head *list;
    387                
    388                __parse_obj_Group(i, &res);
    389                
    390                if (res.is_member == 1)
    391                  list = &my_groups;
    392                else
    393                  list = &groups;
    394                
    395                if (find_Group(list, res.id) == 0)
   \                     ??__parse_obj_groups_2:
   \   00000028   08109DE5           LDR      R1,[SP, #+8]
   \   0000002C   0500A0E1           MOV      R0,R5
   \   00000030   ........           _BLF     find_Group,??find_Group??rA
   \   00000034   000050E3           CMP      R0,#+0
   \   00000038   1100001A           BNE      ??__parse_obj_groups_3
    396                {
    397                  VkGroup *group = new_Group(&res);
   \   0000003C   0D00A0E1           MOV      R0,SP
   \   00000040   ........           _BLF     new_Group,??new_Group??rA
   \   00000044   0060A0E1           MOV      R6,R0
    398                  list_add_tail(&group->list, list);
   \   00000048   040095E5           LDR      R0,[R5, #+4]
   \   0000004C   046085E5           STR      R6,[R5, #+4]
   \   00000050   005086E5           STR      R5,[R6, #+0]
   \   00000054   040086E5           STR      R0,[R6, #+4]
   \   00000058   006080E5           STR      R6,[R0, #+0]
    399                  VkDialog *dialog = FindDialog(&dialogs, group->id);
   \   0000005C   ........           LDR      R0,??DataTable57  ;; dialogs
   \   00000060   081096E5           LDR      R1,[R6, #+8]
   \   00000064   ........           _BLF     FindDialog,??FindDialog??rA
   \   00000068   0050B0E1           MOVS     R5,R0
    400                  if (dialog)
   \   0000006C   0400000A           BEQ      ??__parse_obj_groups_3
    401                  {
    402                    if (dialog->group)//если вдруг уже создан
   \   00000070   200095E5           LDR      R0,[R5, #+32]
   \   00000074   000050E3           CMP      R0,#+0
   \   00000078   0000000A           BEQ      ??__parse_obj_groups_4
    403                      del_Group(dialog->group);
   \   0000007C   ........           _BLF     del_Group,??del_Group??rA
    404                    dialog->group = group;
   \                     ??__parse_obj_groups_4:
   \   00000080   206085E5           STR      R6,[R5, #+32]
    405                  }
    406                }
   \                     ??__parse_obj_groups_3:
   \   00000084   004094E5           LDR      R4,[R4, #+0]
   \                     ??__parse_obj_groups_1:
   \   00000088   000054E3           CMP      R4,#+0
   \   0000008C   0700000A           BEQ      ??__parse_obj_groups_0
   \   00000090   0D10A0E1           MOV      R1,SP
   \   00000094   0400A0E1           MOV      R0,R4
   \   00000098   ........           BL       __parse_obj_Group
   \   0000009C   20009DE5           LDR      R0,[SP, #+32]
   \   000000A0   010050E3           CMP      R0,#+1
   \   000000A4   0C509F15           LDRNE    R5,??__parse_obj_groups_5  ;; groups
   \   000000A8   0C509F05           LDREQ    R5,??__parse_obj_groups_5+0x4  ;; my_groups
   \   000000AC   DDFFFFEA           B        ??__parse_obj_groups_2
    407              }
    408            } 
    409          }
   \                     ??__parse_obj_groups_0:
   \   000000B0   2CD08DE2           ADD      SP,SP,#+44       ;; stack cleaning
   \   000000B4   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??__parse_obj_groups_5:
   \   000000B8   ........           DC32     groups
   \   000000BC   ........           DC32     my_groups
    410          /******************************************************************************/
    411          

   \                                 In segment CODE, align 4, keep-with-next
    412          int parse_answer_groups_get(char *json_answer, int *count)
    413          {
   \                     parse_answer_groups_get:
   \   00000000   F1412DE9           PUSH     {R0,R4-R8,LR}
   \   00000004   0150A0E1           MOV      R5,R1
    414            int error = 0;
   \   00000008   0040A0E3           MOV      R4,#+0
    415            cJSON *j_err;
    416            const char *return_parse_end = 0;
   \   0000000C   0020A0E3           MOV      R2,#+0
   \   00000010   00208DE5           STR      R2,[SP, #+0]
    417            
    418            cJSON *json = cJSON_ParseWithOpts(json_answer, &return_parse_end, 0);
   \   00000014   0D10A0E1           MOV      R1,SP
   \   00000018   ........           _BLF     cJSON_ParseWithOpts,??cJSON_ParseWithOpts??rA
   \   0000001C   0060B0E1           MOVS     R6,R0
    419            if (json == NULL)
    420              return(-1);//cJSON parse error
   \   00000020   0400E001           MVNEQ    R0,R4
   \   00000024   F281BD08           POPEQ    {R1,R4-R8,PC}
    421            
    422            cJSON* j_response = cJSON_GetObjectItem(json, t_response);
   \   00000028   ........           LDR      R7,??DataTable56  ;; `?<Constant "access_token">`
   \   0000002C   B41087E2           ADD      R1,R7,#+180
   \   00000030   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   00000034   0080B0E1           MOVS     R8,R0
    423            
    424            if (j_response)
   \   00000038   0B00000A           BEQ      ??parse_answer_groups_get_0
    425            {
    426              cJSON* j_count = cJSON_GetObjectItem(j_response, t_count);
   \   0000003C   C01087E2           ADD      R1,R7,#+192
   \   00000040   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    427              if (j_count)
   \   00000044   000050E3           CMP      R0,#+0
    428                *count = j_count->valueint;
   \   00000048   14009015           LDRNE    R0,[R0, #+20]
    429              
    430              cJSON *j_items = cJSON_GetObjectItem(j_response, t_items);    
   \   0000004C   C81087E2           ADD      R1,R7,#+200
   \   00000050   00008515           STRNE    R0,[R5, #+0]
   \   00000054   0800A0E1           MOV      R0,R8
   \   00000058   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    431              if (j_items)
   \   0000005C   000050E3           CMP      R0,#+0
   \   00000060   0800000A           BEQ      ??parse_answer_groups_get_1
    432                __parse_obj_groups(j_items);
   \   00000064   ........           BL       __parse_obj_groups
   \   00000068   060000EA           B        ??parse_answer_groups_get_1
    433            }
    434            else
    435              if (j_err = cJSON_GetObjectItem(json, t_error))
   \                     ??parse_answer_groups_get_0:
   \   0000006C   AC1087E2           ADD      R1,R7,#+172
   \   00000070   0600A0E1           MOV      R0,R6
   \   00000074   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   00000078   000050E3           CMP      R0,#+0
   \   0000007C   0100000A           BEQ      ??parse_answer_groups_get_1
    436                error = __parse_obj_Error(j_err);
   \   00000080   ........           BL       __parse_obj_Error
   \   00000084   0040A0E1           MOV      R4,R0
    437            
    438            if (json) cJSON_Delete(json);
   \                     ??parse_answer_groups_get_1:
   \   00000088   0600A0E1           MOV      R0,R6
   \   0000008C   ........           B        ?Subroutine32
    439            
    440            return error;
    441          }

   \                                 In segment CODE, align 4, keep-with-next
   \                     ?Subroutine32:
   \   00000000   ........           _BLF     cJSON_Delete,??cJSON_Delete??rA
   \   00000004   0400A0E1           MOV      R0,R4
   \   00000008   F281BDE8           POP      {R1,R4-R8,PC}    ;; return
   \                     ??Subroutine32_0:
   \   0000000C   ........           DC32     my_id
    442          
    443          //******************************************************************************
    444          

   \                                 In segment CODE, align 4, keep-with-next
    445          int __parse_answer_users_get()
    446          {
    447            int error = 0;
    448            
    449            char* end = (char*)(recv_buf+HTTP_HEADER_LENGTH+HTTP_CONTENT_LENGTH);
    450            *end = '\0';
   \                     __parse_answer_users_get:
   \   00000000   ........           LDR      R0,??DataTable54  ;; HTTP_HEADER_LENGTH
   \   00000004   ........           LDR      R1,??DataTable52  ;; recv_buf
   \   00000008   ........           LDR      R2,??DataTable53  ;; HTTP_CONTENT_LENGTH
   \   0000000C   F0402DE9           PUSH     {R4-R7,LR}
   \   00000010   28D04DE2           SUB      SP,SP,#+40
   \   00000014   002092E5           LDR      R2,[R2, #+0]
   \   00000018   003090E5           LDR      R3,[R0, #+0]
   \   0000001C   005091E5           LDR      R5,[R1, #+0]
   \   00000020   0040A0E3           MOV      R4,#+0
   \   00000024   053083E0           ADD      R3,R3,R5
   \   00000028   0050A0E3           MOV      R5,#+0
   \   0000002C   0350C2E7           STRB     R5,[R2, +R3]
    451            
    452            cJSON* json = cJSON_Parse(recv_buf + HTTP_HEADER_LENGTH);
   \   00000030   000090E5           LDR      R0,[R0, #+0]
   \   00000034   001091E5           LDR      R1,[R1, #+0]
   \   00000038   010080E0           ADD      R0,R0,R1
   \   0000003C   ........           _BLF     cJSON_Parse,??cJSON_Parse??rA
   \   00000040   0050B0E1           MOVS     R5,R0
    453            if (json == NULL)
   \   00000044   2500000A           BEQ      ??__parse_answer_users_get_0
    454              return 0;
    455            
    456            cJSON* j_response = cJSON_GetObjectItem(json, t_response);
   \   00000048   ........           LDR      R6,??DataTable56  ;; `?<Constant "access_token">`
   \   0000004C   B41086E2           ADD      R1,R6,#+180
   \   00000050   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   00000054   0070B0E1           MOVS     R7,R0
    457            if (j_response)
   \   00000058   1700000A           BEQ      ??__parse_answer_users_get_1
    458            {
    459              if (cJSON_GetArraySize(j_response) > 0)
   \   0000005C   ........           _BLF     cJSON_GetArraySize,??cJSON_GetArraySize??rA
   \   00000060   010050E3           CMP      R0,#+1
   \   00000064   1B0000BA           BLT      ??__parse_answer_users_get_2
   \   00000068   086097E5           LDR      R6,[R7, #+8]
   \   0000006C   ........           LDR      R7,??DataTable43  ;; profiles
    460              {
    461                cJSON* i = NULL;
    462                cJSON_ArrayForEach(i, j_response)
   \                     ??__parse_answer_users_get_3:
   \   00000070   000056E3           CMP      R6,#+0
   \   00000074   1700000A           BEQ      ??__parse_answer_users_get_2
    463                {
    464                  struct user_args res;
    465                  
    466                  __parse_obj_User(i, &res);
   \   00000078   0D10A0E1           MOV      R1,SP
   \   0000007C   0600A0E1           MOV      R0,R6
   \   00000080   ........           BL       __parse_obj_User
    467                  
    468                  if (find_User(&profiles, res.id) == 0)
   \   00000084   00109DE5           LDR      R1,[SP, #+0]
   \   00000088   0700A0E1           MOV      R0,R7
   \   0000008C   ........           _BLF     find_User,??find_User??rA
   \   00000090   000050E3           CMP      R0,#+0
   \   00000094   0600001A           BNE      ??__parse_answer_users_get_4
    469                  {
    470                    VkUser *user = new_User(&res);
   \   00000098   0D00A0E1           MOV      R0,SP
   \   0000009C   ........           _BLF     new_User,??new_User??rA
    471                    list_add(&user->list, &profiles);
   \   000000A0   001097E5           LDR      R1,[R7, #+0]
   \   000000A4   040081E5           STR      R0,[R1, #+4]
   \   000000A8   001080E5           STR      R1,[R0, #+0]
   \   000000AC   047080E5           STR      R7,[R0, #+4]
   \   000000B0   000087E5           STR      R0,[R7, #+0]
    472                  }
    473                }
   \                     ??__parse_answer_users_get_4:
   \   000000B4   006096E5           LDR      R6,[R6, #+0]
   \   000000B8   ECFFFFEA           B        ??__parse_answer_users_get_3
    474              }
    475            }
    476            else
    477              if (j_response = cJSON_GetObjectItem(json, t_error))
   \                     ??__parse_answer_users_get_1:
   \   000000BC   AC1086E2           ADD      R1,R6,#+172
   \   000000C0   0500A0E1           MOV      R0,R5
   \   000000C4   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   000000C8   0070B0E1           MOVS     R7,R0
   \   000000CC   0100000A           BEQ      ??__parse_answer_users_get_2
    478                error = __parse_obj_Error(j_response);
   \   000000D0   ........           BL       __parse_obj_Error
   \   000000D4   0040A0E1           MOV      R4,R0
    479            
    480            if (json) cJSON_Delete(json);
   \                     ??__parse_answer_users_get_2:
   \   000000D8   0500A0E1           MOV      R0,R5
   \   000000DC   ........           _BLF     cJSON_Delete,??cJSON_Delete??rA
    481            
    482            return error;
   \                     ??__parse_answer_users_get_0:
   \   000000E0   0400A0E1           MOV      R0,R4
   \   000000E4   28D08DE2           ADD      SP,SP,#+40
   \   000000E8   F080BDE8           POP      {R4-R7,PC}       ;; return
    483          }
    484          /******************************************************************************/
    485          

   \                                 In segment CODE, align 4, keep-with-next
    486          int __parse_answer_friends_get()
    487          {
    488            return parse_answer_users_get();  
   \                     __parse_answer_friends_get:
   \   00000000   ........           _BF      parse_answer_users_get,??parse_answer_users_get??rA  ;; tailcall
    489          }
    490          
    491          /******************************************************************************/
    492          

   \                                 In segment CODE, align 4, keep-with-next
    493          int parse_answer_auth_direct()
    494          {
    495            int error = 0;
    496            const char *return_parse_end;
    497            
    498            cJSON *json = cJSON_ParseWithOpts(recv_buf+HTTP_HEADER_LENGTH, &return_parse_end, 0);
   \                     parse_answer_auth_direct:
   \   00000000   ........           LDR      R3,??DataTable52  ;; recv_buf
   \   00000004   F1412DE9           PUSH     {R0,R4-R8,LR}
   \   00000008   ........           LDR      R0,??DataTable54  ;; HTTP_HEADER_LENGTH
   \   0000000C   003093E5           LDR      R3,[R3, #+0]
   \   00000010   000090E5           LDR      R0,[R0, #+0]
   \   00000014   0040A0E3           MOV      R4,#+0
   \   00000018   0020A0E3           MOV      R2,#+0
   \   0000001C   0D10A0E1           MOV      R1,SP
   \   00000020   030080E0           ADD      R0,R0,R3
   \   00000024   ........           _BLF     cJSON_ParseWithOpts,??cJSON_ParseWithOpts??rA
   \   00000028   0050B0E1           MOVS     R5,R0
    499            if (json == NULL)
    500              return(-1);//cJSON parse error
   \   0000002C   0400E001           MVNEQ    R0,R4
   \   00000030   F281BD08           POPEQ    {R1,R4-R8,PC}
    501            
    502            cJSON* j_item = cJSON_GetObjectItem(json, "access_token");
   \   00000034   ........           LDR      R6,??DataTable56  ;; `?<Constant "access_token">`
    503            if (j_item)
   \   00000038   ........           LDR      R7,??Subroutine32_0  ;; my_id
   \   0000003C   0610A0E1           MOV      R1,R6
   \   00000040   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   00000044   000050E3           CMP      R0,#+0
   \   00000048   0B00000A           BEQ      ??parse_answer_auth_direct_0
    504            {
    505              strncpy(ACCESS_TOKEN, j_item->valuestring, ACCESS_TOKEN_MAXLEN-1);
   \   0000004C   101090E5           LDR      R1,[R0, #+16]
   \   00000050   FF20A0E3           MOV      R2,#+255
   \   00000054   0C0087E2           ADD      R0,R7,#+12
   \   00000058   160100EF           SWI      +278
    506              
    507              j_item = cJSON_GetObjectItem(json, "user_id");
   \   0000005C   101086E2           ADD      R1,R6,#+16
   \   00000060   0500A0E1           MOV      R0,R5
   \   00000064   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   00000068   0080B0E1           MOVS     R8,R0
    508              if (j_item)
   \   0000006C   2C00000A           BEQ      ??parse_answer_auth_direct_1
    509                my_id = j_item->valueint;
   \   00000070   140090E5           LDR      R0,[R0, #+20]
   \   00000074   000087E5           STR      R0,[R7, #+0]
   \   00000078   290000EA           B        ??parse_answer_auth_direct_1
    510            }
    511            else
    512              if (j_item = cJSON_GetObjectItem(json, t_error))
   \                     ??parse_answer_auth_direct_0:
   \   0000007C   AC1086E2           ADD      R1,R6,#+172
   \   00000080   0500A0E1           MOV      R0,R5
   \   00000084   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   00000088   0080B0E1           MOVS     R8,R0
   \   0000008C   2400000A           BEQ      ??parse_answer_auth_direct_1
    513              {
    514                if (strcmp(j_item->valuestring, "need_captcha") == 0)
   \   00000090   100098E5           LDR      R0,[R8, #+16]
   \   00000094   434FA0E3           MOV      R4,#+268
   \   00000098   3C1086E2           ADD      R1,R6,#+60
   \   0000009C   190000EF           SWI      +25
   \   000000A0   000050E3           CMP      R0,#+0
   \   000000A4   0500001A           BNE      ??parse_answer_auth_direct_2
    515                {
    516                  strncpy(err_msg, j_item->valuestring, 255);
   \   000000A8   101098E5           LDR      R1,[R8, #+16]
   \   000000AC   FF20A0E3           MOV      R2,#+255
   \   000000B0   070084E0           ADD      R0,R4,R7
   \   000000B4   160100EF           SWI      +278
    517                  error = 14;
   \   000000B8   0E40A0E3           MOV      R4,#+14
   \   000000BC   180000EA           B        ??parse_answer_auth_direct_1
    518                }
    519                else
    520                  if (stricmp(j_item->valuestring, "need_validation") == 0)
   \                     ??parse_answer_auth_direct_2:
   \   000000C0   100098E5           LDR      R0,[R8, #+16]
   \   000000C4   2C1086E2           ADD      R1,R6,#+44
   \   000000C8   ........           _BLF     stricmp,??stricmp??rA
   \   000000CC   000050E3           CMP      R0,#+0
   \   000000D0   0500001A           BNE      ??parse_answer_auth_direct_3
    521                  {
    522                    strncpy(err_msg, j_item->valuestring, 255);
   \   000000D4   101098E5           LDR      R1,[R8, #+16]
   \   000000D8   FF20A0E3           MOV      R2,#+255
   \   000000DC   070084E0           ADD      R0,R4,R7
   \   000000E0   160100EF           SWI      +278
    523                    error = 17;
   \   000000E4   1140A0E3           MOV      R4,#+17
   \   000000E8   0D0000EA           B        ??parse_answer_auth_direct_1
    524                  }
    525                  else
    526                    if (j_item = cJSON_GetObjectItem(json, "error_description"))
   \                     ??parse_answer_auth_direct_3:
   \   000000EC   181086E2           ADD      R1,R6,#+24
   \   000000F0   0500A0E1           MOV      R0,R5
   \   000000F4   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   000000F8   0080B0E1           MOVS     R8,R0
   \   000000FC   0300000A           BEQ      ??parse_answer_auth_direct_4
    527                      {
    528                        utf82win(err_msg, j_item->valuestring);
   \   00000100   101090E5           LDR      R1,[R0, #+16]
   \   00000104   070084E0           ADD      R0,R4,R7
   \   00000108   ........           _BLF     utf82win,??utf82win??rA
    529                        error = 1;
   \   0000010C   030000EA           B        ??parse_answer_auth_direct_5
    530                      }
    531                    else
    532                    {
    533                      strncpy(err_msg, j_item->valuestring, 255);
   \                     ??parse_answer_auth_direct_4:
   \   00000110   101090E5           LDR      R1,[R0, #+16]
   \   00000114   FF20A0E3           MOV      R2,#+255
   \   00000118   070084E0           ADD      R0,R4,R7
   \   0000011C   160100EF           SWI      +278
    534                      error = 1;
   \                     ??parse_answer_auth_direct_5:
   \   00000120   0140A0E3           MOV      R4,#+1
    535                    }
    536              }
    537            
    538            if (json)
    539              cJSON_Delete(json);
   \                     ??parse_answer_auth_direct_1:
   \   00000124   0500A0E1           MOV      R0,R5
   \   00000128                      REQUIRE ?Subroutine32
   \   00000128                      ;; // Fall through to label ?Subroutine32
    540           
    541            return error;
    542          }
    543          
    544          //***************************** messages.getLongPollServer *********************
    545          

   \                                 In segment CODE, align 4, keep-with-next
    546          int parse_answer_messages_getLongPollServer() /* json->response->{key, server, ts, pts} */
    547          { 
    548            int error = 0;
    549            
    550            char* end=(char*)(recv_buf+HTTP_HEADER_LENGTH+HTTP_CONTENT_LENGTH);
    551            *end='\0';
   \                     parse_answer_messages_getLongPollServer:
   \   00000000   ........           LDR      R0,??DataTable54  ;; HTTP_HEADER_LENGTH
   \   00000004   ........           LDR      R1,??DataTable52  ;; recv_buf
   \   00000008   ........           LDR      R2,??DataTable53  ;; HTTP_CONTENT_LENGTH
   \   0000000C   F0412DE9           PUSH     {R4-R8,LR}
   \   00000010   002092E5           LDR      R2,[R2, #+0]
   \   00000014   003090E5           LDR      R3,[R0, #+0]
   \   00000018   005091E5           LDR      R5,[R1, #+0]
   \   0000001C   0040A0E3           MOV      R4,#+0
   \   00000020   053083E0           ADD      R3,R3,R5
   \   00000024   0050A0E3           MOV      R5,#+0
   \   00000028   0350C2E7           STRB     R5,[R2, +R3]
    552            
    553            cJSON* json = cJSON_Parse(recv_buf+HTTP_HEADER_LENGTH);
   \   0000002C   000090E5           LDR      R0,[R0, #+0]
   \   00000030   001091E5           LDR      R1,[R1, #+0]
   \   00000034   010080E0           ADD      R0,R0,R1
   \   00000038   ........           _BLF     cJSON_Parse,??cJSON_Parse??rA
   \   0000003C   0050B0E1           MOVS     R5,R0
    554            if (json == NULL)
   \   00000040   3100000A           BEQ      ??parse_answer_messages_getLongPollServer_0
    555              return 0;
    556            
    557            cJSON* j_response = cJSON_GetObjectItem(json, t_response);
   \   00000044   ........           LDR      R8,??DataTable56  ;; `?<Constant "access_token">`
   \   00000048   B41088E2           ADD      R1,R8,#+180
   \   0000004C   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   00000050   0070B0E1           MOVS     R7,R0
    558            if (j_response)
   \   00000054   2300000A           BEQ      ??parse_answer_messages_getLongPollServer_1
    559            {
    560              error = 0;
    561              
    562              cJSON* j_item = cJSON_GetObjectItem(j_response, "key");
    563              if (j_item)
   \   00000058   ........           LDR      R6,??DataTable51  ;; my_id
   \   0000005C   2C1F8FE2           ADR      R1,??parse_answer_messages_getLongPollServer_2  ;; "key"
   \   00000060   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   00000064   000050E3           CMP      R0,#+0
   \   00000068   0500000A           BEQ      ??parse_answer_messages_getLongPollServer_3
    564                strncpy(lp_key, j_item->valuestring, 63);
   \   0000006C   101090E5           LDR      R1,[R0, #+16]
   \   00000070   3F20A0E3           MOV      R2,#+63
   \   00000074   0C00A0E3           MOV      R0,#+12
   \   00000078   600E80E3           ORR      R0,R0,#0x600
   \   0000007C   060080E0           ADD      R0,R0,R6
   \   00000080   160100EF           SWI      +278
    565              
    566              j_item = cJSON_GetObjectItem(j_response, "server");
   \                     ??parse_answer_messages_getLongPollServer_3:
   \   00000084   A41088E2           ADD      R1,R8,#+164
   \   00000088   0700A0E1           MOV      R0,R7
   \   0000008C   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    567              if (j_item)
   \   00000090   000050E3           CMP      R0,#+0
   \   00000094   0500000A           BEQ      ??parse_answer_messages_getLongPollServer_4
    568                strncpy(lp_server, j_item->valuestring, 31);
   \   00000098   101090E5           LDR      R1,[R0, #+16]
   \   0000009C   1F20A0E3           MOV      R2,#+31
   \   000000A0   4C00A0E3           MOV      R0,#+76
   \   000000A4   600E80E3           ORR      R0,R0,#0x600
   \   000000A8   060080E0           ADD      R0,R0,R6
   \   000000AC   160100EF           SWI      +278
    569              
    570              j_item = cJSON_GetObjectItem(j_response, "ts");
   \                     ??parse_answer_messages_getLongPollServer_4:
   \   000000B0   181F8FE2           ADR      R1,??parse_answer_messages_getLongPollServer_2+0x4  ;; "ts"
   \   000000B4   0700A0E1           MOV      R0,R7
   \   000000B8   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    571              if (j_item)
   \   000000BC   000050E3           CMP      R0,#+0
    572                lp_ts = j_item->valueint;
   \   000000C0   14009015           LDRNE    R0,[R0, #+20]
    573              
    574              j_item = cJSON_GetObjectItem(j_response, "pts");
   \   000000C4   141F8FE2           ADR      R1,??parse_answer_messages_getLongPollServer_2+0x8  ;; "pts"
   \   000000C8   04008615           STRNE    R0,[R6, #+4]
   \   000000CC   0700A0E1           MOV      R0,R7
   \   000000D0   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    575              if (j_item)
   \   000000D4   000050E3           CMP      R0,#+0
   \   000000D8   0900000A           BEQ      ??parse_answer_messages_getLongPollServer_5
    576                pts = j_item->valueint;
   \   000000DC   140090E5           LDR      R0,[R0, #+20]
   \   000000E0   080086E5           STR      R0,[R6, #+8]
   \   000000E4   060000EA           B        ??parse_answer_messages_getLongPollServer_5
    577            }
    578            else
    579              if (j_response = cJSON_GetObjectItem(json, t_error))
   \                     ??parse_answer_messages_getLongPollServer_1:
   \   000000E8   AC1088E2           ADD      R1,R8,#+172
   \   000000EC   0500A0E1           MOV      R0,R5
   \   000000F0   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   000000F4   0070B0E1           MOVS     R7,R0
   \   000000F8   0100000A           BEQ      ??parse_answer_messages_getLongPollServer_5
    580                error = __parse_obj_Error(j_response);
   \   000000FC   ........           BL       __parse_obj_Error
   \   00000100   0040A0E1           MOV      R4,R0
    581              
    582            if (json) cJSON_Delete(json);
   \                     ??parse_answer_messages_getLongPollServer_5:
   \   00000104   0500A0E1           MOV      R0,R5
   \   00000108   ........           _BLF     cJSON_Delete,??cJSON_Delete??rA
    583            
    584            return error;
   \                     ??parse_answer_messages_getLongPollServer_0:
   \   0000010C   0400A0E1           MOV      R0,R4
   \   00000110   F081BDE8           POP      {R4-R8,PC}       ;; return
   \                     ??parse_answer_messages_getLongPollServer_2:
   \   00000114   6B657900           DC8      "key"
   \   00000118   74730000           DC8      "ts",+0
   \   0000011C   70747300           DC8      "pts"
    585          }
    586          
    587          //************************** messages.getLongPollHistory ***********************
    588          

   \                                 In segment CODE, align 4, keep-with-next
    589          int parse_answer_messages_getLongPollHistory(LIST_HEAD *messages, LIST_HEAD *profiles)
    590          {/* json->response->{history[], messages->{count, items[{conversation, last_message}], new_pts, profiles[], conversations[]} */
    591            
    592            int error = 0;
    593            int count = 0;
    594            
    595            char* end=(char*)(recv_buf+HTTP_HEADER_LENGTH+HTTP_CONTENT_LENGTH);
    596            *end='\0';
   \                     parse_answer_messages_getLongPollHistory:
   \   00000000   ........           LDR      R1,??DataTable52  ;; recv_buf
   \   00000004   ........           LDR      R2,??DataTable53  ;; HTTP_CONTENT_LENGTH
   \   00000008   F0432DE9           PUSH     {R4-R9,LR}
   \   0000000C   0050A0E1           MOV      R5,R0
   \   00000010   ........           LDR      R0,??DataTable54  ;; HTTP_HEADER_LENGTH
   \   00000014   20D04DE2           SUB      SP,SP,#+32
   \   00000018   002092E5           LDR      R2,[R2, #+0]
   \   0000001C   003090E5           LDR      R3,[R0, #+0]
   \   00000020   006091E5           LDR      R6,[R1, #+0]
   \   00000024   0040A0E3           MOV      R4,#+0
   \   00000028   063083E0           ADD      R3,R3,R6
   \   0000002C   0060A0E3           MOV      R6,#+0
   \   00000030   0360C2E7           STRB     R6,[R2, +R3]
    597            
    598            cJSON* json = cJSON_Parse(recv_buf+HTTP_HEADER_LENGTH);
   \   00000034   000090E5           LDR      R0,[R0, #+0]
   \   00000038   001091E5           LDR      R1,[R1, #+0]
   \   0000003C   010080E0           ADD      R0,R0,R1
   \   00000040   ........           _BLF     cJSON_Parse,??cJSON_Parse??rA
   \   00000044   0060B0E1           MOVS     R6,R0
    599            if (json == NULL)
   \   00000048   3D00000A           BEQ      ??parse_answer_messages_getLongPollHistory_0
    600              return 0;
    601            
    602            cJSON* j_response = cJSON_GetObjectItem(json, t_response);
   \   0000004C   ........           LDR      R7,??DataTable56  ;; `?<Constant "access_token">`
   \   00000050   B41087E2           ADD      R1,R7,#+180
   \   00000054   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   00000058   0080B0E1           MOVS     R8,R0
    603            if (j_response)
   \   0000005C   2F00000A           BEQ      ??parse_answer_messages_getLongPollHistory_1
    604            { 
    605              cJSON* j_messages = cJSON_GetObjectItem(j_response, "messages");
   \   00000060   4C1087E2           ADD      R1,R7,#+76
   \   00000064   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   00000068   0090B0E1           MOVS     R9,R0
    606              if (j_messages)
   \   0000006C   1D00000A           BEQ      ??parse_answer_messages_getLongPollHistory_2
    607              {
    608                cJSON* j_count = cJSON_GetObjectItem(j_messages, t_count);
   \   00000070   C01087E2           ADD      R1,R7,#+192
   \   00000074   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    609                if (j_count)
    610                  count = j_count->valueint;
    611                
    612                cJSON* j_items = cJSON_GetObjectItem(j_messages, t_items);
   \   00000078   C81087E2           ADD      R1,R7,#+200
   \   0000007C   0900A0E1           MOV      R0,R9
   \   00000080   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   00000084   0090B0E1           MOVS     R9,R0
    613                if (j_items)
   \   00000088   1600000A           BEQ      ??parse_answer_messages_getLongPollHistory_2
    614                {                            
    615                  if (cJSON_GetArraySize(j_items) > 0)
   \   0000008C   ........           _BLF     cJSON_GetArraySize,??cJSON_GetArraySize??rA
   \   00000090   010050E3           CMP      R0,#+1
   \   00000094   130000BA           BLT      ??parse_answer_messages_getLongPollHistory_2
   \   00000098   089099E5           LDR      R9,[R9, #+8]
   \   0000009C   0F0000EA           B        ??parse_answer_messages_getLongPollHistory_3
    616                  {
    617                    cJSON* i = NULL;              
    618                    cJSON_ArrayForEach(i, j_items)
    619                    {
    620                      struct message_args __msg_args;
    621                      LIST_HEAD(__attachments);
   \                     ??parse_answer_messages_getLongPollHistory_4:
   \   000000A0   0D10A0E1           MOV      R1,SP
   \   000000A4   00108DE5           STR      R1,[SP, #+0]
   \   000000A8   04108DE5           STR      R1,[SP, #+4]
    622                      __parse_obj_Message(i, &__msg_args, &__attachments);
   \   000000AC   0D20A0E1           MOV      R2,SP
   \   000000B0   08108DE2           ADD      R1,SP,#+8
   \   000000B4   0900A0E1           MOV      R0,R9
   \   000000B8   ........           BL       __parse_obj_Message
    623                      VkMsg *message = new_Message(&__msg_args, &__attachments);
   \   000000BC   0D10A0E1           MOV      R1,SP
   \   000000C0   08008DE2           ADD      R0,SP,#+8
   \   000000C4   ........           _BLF     new_Message,??new_Message??rA
    624                      list_add(&message->list, messages);
   \   000000C8   001095E5           LDR      R1,[R5, #+0]
   \   000000CC   040081E5           STR      R0,[R1, #+4]
   \   000000D0   001080E5           STR      R1,[R0, #+0]
   \   000000D4   045080E5           STR      R5,[R0, #+4]
   \   000000D8   000085E5           STR      R0,[R5, #+0]
    625                    }
   \   000000DC   009099E5           LDR      R9,[R9, #+0]
   \                     ??parse_answer_messages_getLongPollHistory_3:
   \   000000E0   000059E3           CMP      R9,#+0
   \   000000E4   EDFFFF1A           BNE      ??parse_answer_messages_getLongPollHistory_4
    626                  }
    627                }
    628              }
    629              
    630              cJSON* j_new_pts = cJSON_GetObjectItem(j_response, "new_pts");
   \                     ??parse_answer_messages_getLongPollHistory_2:
   \   000000E8   581087E2           ADD      R1,R7,#+88
   \   000000EC   0800A0E1           MOV      R0,R8
   \   000000F0   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    631              if (j_new_pts)
   \   000000F4   000050E3           CMP      R0,#+0
    632                pts = j_new_pts->valueint;
   \   000000F8   50109F15           LDRNE    R1,??parse_answer_messages_getLongPollHistory_5  ;; my_id + 8
   \   000000FC   14009015           LDRNE    R0,[R0, #+20]
   \   00000100   00008115           STRNE    R0,[R1, #+0]
    633              
    634              cJSON* j_profiles = cJSON_GetObjectItem(j_response, t_profiles);
   \   00000104   D01087E2           ADD      R1,R7,#+208
   \   00000108   0800A0E1           MOV      R0,R8
   \   0000010C   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    635              if (j_profiles)
   \   00000110   000050E3           CMP      R0,#+0
   \   00000114   0800000A           BEQ      ??parse_answer_messages_getLongPollHistory_6
    636                __parse_obj_profiles(j_profiles);
   \   00000118   ........           BL       __parse_obj_profiles
   \   0000011C   060000EA           B        ??parse_answer_messages_getLongPollHistory_6
    637            }
    638            else
    639              if (j_response = cJSON_GetObjectItem(json, t_error))
   \                     ??parse_answer_messages_getLongPollHistory_1:
   \   00000120   AC1087E2           ADD      R1,R7,#+172
   \   00000124   0600A0E1           MOV      R0,R6
   \   00000128   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   0000012C   0080B0E1           MOVS     R8,R0
   \   00000130   0100000A           BEQ      ??parse_answer_messages_getLongPollHistory_6
    640                error = __parse_obj_Error(j_response);
   \   00000134   ........           BL       __parse_obj_Error
   \   00000138   0040A0E1           MOV      R4,R0
    641            
    642            if (json) cJSON_Delete(json);
   \                     ??parse_answer_messages_getLongPollHistory_6:
   \   0000013C   0600A0E1           MOV      R0,R6
   \   00000140   ........           _BLF     cJSON_Delete,??cJSON_Delete??rA
    643          
    644            return error;
   \                     ??parse_answer_messages_getLongPollHistory_0:
   \   00000144   0400A0E1           MOV      R0,R4
   \   00000148   20D08DE2           ADD      SP,SP,#+32
   \   0000014C   F083BDE8           POP      {R4-R9,PC}       ;; return
   \                     ??parse_answer_messages_getLongPollHistory_5:
   \   00000150   ........           DC32     my_id + 8
    645          }
    646          
    647          //************************** messages.getConversations *************************
    648          

   \                                 In segment CODE, align 4, keep-with-next
    649          int parse_answer_messages_getConversations(char *json_answer, int *count)
    650          {/* json->response->{count, items[{conversation, last_message}], profiles[]} */
   \                     parse_answer_messages_getConversations:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
   \   00000004   2CD04DE2           SUB      SP,SP,#+44
   \   00000008   0160A0E1           MOV      R6,R1
    651            int error = 0;
   \   0000000C   0020A0E3           MOV      R2,#+0
   \   00000010   0C208DE5           STR      R2,[SP, #+12]
    652            const char *return_parse_end = 0;
   \   00000014   10208DE5           STR      R2,[SP, #+16]
    653            
    654            cJSON *json = cJSON_ParseWithOpts(json_answer, &return_parse_end, 0);
   \   00000018   10108DE2           ADD      R1,SP,#+16
   \   0000001C   ........           _BLF     cJSON_ParseWithOpts,??cJSON_ParseWithOpts??rA
   \   00000020   00008DE5           STR      R0,[SP, #+0]
    655            if (json == NULL)
   \   00000024   000050E3           CMP      R0,#+0
    656              return(-1);//cJSON parse error
   \   00000028   0000E003           MVNEQ    R0,#+0
   \   0000002C   6700000A           BEQ      ??parse_answer_messages_getConversations_0
    657            
    658            cJSON* j_response = cJSON_GetObjectItem(json, t_response);
   \   00000030   ........           LDR      R5,??DataTable56  ;; `?<Constant "access_token">`
   \   00000034   B41085E2           ADD      R1,R5,#+180
   \   00000038   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   0000003C   0040B0E1           MOVS     R4,R0
    659            if (j_response)
   \   00000040   5800000A           BEQ      ??parse_answer_messages_getConversations_1
    660            {
    661              cJSON* j_count = cJSON_GetObjectItem(j_response, t_count);
   \   00000044   C01085E2           ADD      R1,R5,#+192
   \   00000048   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    662              if (j_count)
   \   0000004C   000050E3           CMP      R0,#+0
    663                *count = j_count->valueint;    
   \   00000050   14009015           LDRNE    R0,[R0, #+20]
    664              
    665              cJSON* j_items = cJSON_GetObjectItem(j_response, t_items);
   \   00000054   C81085E2           ADD      R1,R5,#+200
   \   00000058   00008615           STRNE    R0,[R6, #+0]
   \   0000005C   0400A0E1           MOV      R0,R4
   \   00000060   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   00000064   0060B0E1           MOVS     R6,R0
    666              if (j_items)
   \   00000068   4100000A           BEQ      ??parse_answer_messages_getConversations_2
    667              {
    668                if (cJSON_GetArraySize(j_items) > 0)
   \   0000006C   ........           _BLF     cJSON_GetArraySize,??cJSON_GetArraySize??rA
   \   00000070   010050E3           CMP      R0,#+1
   \   00000074   3E0000BA           BLT      ??parse_answer_messages_getConversations_2
   \   00000078   086096E5           LDR      R6,[R6, #+8]
   \   0000007C   ........           LDR      R9,??DataTable57  ;; dialogs
   \   00000080   0A0000EA           B        ??parse_answer_messages_getConversations_3
    669                {       
    670                  cJSON* i = NULL;
    671                  
    672                  cJSON_ArrayForEach(i, j_items)
    673                  {
    674                    int unread_count = 0;
    675                    int out_read = 0;
    676                    cJSON* j_item = cJSON_GetObjectItem(i, "conversation");
    677                    if (j_item)
    678                    {
    679                      j_item = cJSON_GetObjectItem(j_item, "out_read");
    680                      if (j_item)
    681                        out_read = j_item->valueint;            
    682                      
    683                      j_item = cJSON_GetObjectItem(j_item, "unread_count");
    684                      if (j_item)
    685                        unread_count = j_item->valueint;
    686                    }
    687                    
    688                    j_item = cJSON_GetObjectItem(i, "last_message");
    689                    if (j_item)
    690                    {
    691                      struct message_args __msg_args;
    692                      LIST_HEAD(__attachments);
    693                      int id;
    694                      
    695                      __parse_obj_Message(j_item, &__msg_args, &__attachments);
    696                      VkMsg *message = new_Message(&__msg_args, &__attachments);
    697                      
    698                      if (__msg_args.out)
    699                        id = __msg_args.peer_id;
    700                      else
    701                        id = __msg_args.from_id;
    702                      
    703                      VkDialog *dialog = FindDialog(&dialogs, id);
    704                      if (dialog)
    705                      {
    706                        del_Messages(&dialog->messages);
    707                        list_add_tail(&message->list, &dialog->messages);
    708                      }
    709                      else
    710                      {
    711                        dialog = new_Dialog(message, id, unread_count, out_read);
   \                     ??parse_answer_messages_getConversations_4:
   \   00000084   0730A0E1           MOV      R3,R7
   \   00000088   0820A0E1           MOV      R2,R8
   \   0000008C   0B10A0E1           MOV      R1,R11
   \   00000090   0A00A0E1           MOV      R0,R10
   \   00000094   ........           _BLF     new_Dialog,??new_Dialog??rA
    712                        list_add_tail(&dialog->list, &dialogs);       
   \   00000098   041099E5           LDR      R1,[R9, #+4]
   \   0000009C   040089E5           STR      R0,[R9, #+4]
   \   000000A0   009080E5           STR      R9,[R0, #+0]
   \   000000A4   041080E5           STR      R1,[R0, #+4]
   \   000000A8   000081E5           STR      R0,[R1, #+0]
    713                      }
   \                     ??parse_answer_messages_getConversations_5:
   \   000000AC   006096E5           LDR      R6,[R6, #+0]
   \                     ??parse_answer_messages_getConversations_3:
   \   000000B0   000056E3           CMP      R6,#+0
   \   000000B4   2E00000A           BEQ      ??parse_answer_messages_getConversations_2
   \   000000B8   0080A0E3           MOV      R8,#+0
   \   000000BC   0070A0E3           MOV      R7,#+0
   \   000000C0   601085E2           ADD      R1,R5,#+96
   \   000000C4   0600A0E1           MOV      R0,R6
   \   000000C8   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   000000CC   000050E3           CMP      R0,#+0
   \   000000D0   0700000A           BEQ      ??parse_answer_messages_getConversations_6
   \   000000D4   701085E2           ADD      R1,R5,#+112
   \   000000D8   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   000000DC   000050E3           CMP      R0,#+0
   \   000000E0   14709015           LDRNE    R7,[R0, #+20]
   \   000000E4   7C1085E2           ADD      R1,R5,#+124
   \   000000E8   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   000000EC   000050E3           CMP      R0,#+0
   \   000000F0   14809015           LDRNE    R8,[R0, #+20]
   \                     ??parse_answer_messages_getConversations_6:
   \   000000F4   8C1085E2           ADD      R1,R5,#+140
   \   000000F8   0600A0E1           MOV      R0,R6
   \   000000FC   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   00000100   000050E3           CMP      R0,#+0
   \   00000104   E8FFFF0A           BEQ      ??parse_answer_messages_getConversations_5
   \   00000108   04208DE2           ADD      R2,SP,#+4
   \   0000010C   04208DE5           STR      R2,[SP, #+4]
   \   00000110   08208DE5           STR      R2,[SP, #+8]
   \   00000114   14108DE2           ADD      R1,SP,#+20
   \   00000118   ........           BL       __parse_obj_Message
   \   0000011C   04108DE2           ADD      R1,SP,#+4
   \   00000120   14008DE2           ADD      R0,SP,#+20
   \   00000124   ........           _BLF     new_Message,??new_Message??rA
   \   00000128   00A0A0E1           MOV      R10,R0
   \   0000012C   28009DE5           LDR      R0,[SP, #+40]
   \   00000130   000050E3           CMP      R0,#+0
   \   00000134   20B09D15           LDRNE    R11,[SP, #+32]
   \   00000138   0900A0E1           MOV      R0,R9
   \   0000013C   1CB09D05           LDREQ    R11,[SP, #+28]
   \   00000140   0B10A0E1           MOV      R1,R11
   \   00000144   ........           _BLF     FindDialog,??FindDialog??rA
   \   00000148   000050E3           CMP      R0,#+0
   \   0000014C   CCFFFF0A           BEQ      ??parse_answer_messages_getConversations_4
   \   00000150   147080E2           ADD      R7,R0,#+20
   \   00000154   0700A0E1           MOV      R0,R7
   \   00000158   ........           _BLF     del_Messages,??del_Messages??rA
   \   0000015C   040097E5           LDR      R0,[R7, #+4]
   \   00000160   04A087E5           STR      R10,[R7, #+4]
   \   00000164   00708AE5           STR      R7,[R10, #+0]
   \   00000168   04008AE5           STR      R0,[R10, #+4]
   \   0000016C   00A080E5           STR      R10,[R0, #+0]
   \   00000170   CDFFFFEA           B        ??parse_answer_messages_getConversations_5
    714                    }
    715                  }
    716                }
    717              }
    718             
    719            cJSON* j_profiles = cJSON_GetObjectItem(j_response, t_profiles);
   \                     ??parse_answer_messages_getConversations_2:
   \   00000174   D01085E2           ADD      R1,R5,#+208
   \   00000178   0400A0E1           MOV      R0,R4
   \   0000017C   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    720              if (j_profiles)
   \   00000180   000050E3           CMP      R0,#+0
   \   00000184   0000000A           BEQ      ??parse_answer_messages_getConversations_7
    721                __parse_obj_profiles(j_profiles);
   \   00000188   ........           BL       __parse_obj_profiles
    722              
    723            cJSON* j_groups = cJSON_GetObjectItem(j_response, "groups");
   \                     ??parse_answer_messages_getConversations_7:
   \   0000018C   9C1085E2           ADD      R1,R5,#+156
   \   00000190   0400A0E1           MOV      R0,R4
   \   00000194   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
    724              if (j_groups)
   \   00000198   000050E3           CMP      R0,#+0
   \   0000019C   0800000A           BEQ      ??parse_answer_messages_getConversations_8
    725                __parse_obj_groups(j_groups);    
   \   000001A0   ........           BL       __parse_obj_groups
   \   000001A4   060000EA           B        ??parse_answer_messages_getConversations_8
    726            }
    727            else
    728              if (j_response = cJSON_GetObjectItem(json, t_error))
   \                     ??parse_answer_messages_getConversations_1:
   \   000001A8   00009DE5           LDR      R0,[SP, #+0]
   \   000001AC   AC1085E2           ADD      R1,R5,#+172
   \   000001B0   ........           _BLF     cJSON_GetObjectItem,??cJSON_GetObjectItem??rA
   \   000001B4   0040B0E1           MOVS     R4,R0
   \   000001B8   0100000A           BEQ      ??parse_answer_messages_getConversations_8
    729                error = __parse_obj_Error(j_response);
   \   000001BC   ........           BL       __parse_obj_Error
   \   000001C0   0C008DE5           STR      R0,[SP, #+12]
    730            
    731            if (json) cJSON_Delete(json);
   \                     ??parse_answer_messages_getConversations_8:
   \   000001C4   00009DE5           LDR      R0,[SP, #+0]
   \   000001C8   ........           _BLF     cJSON_Delete,??cJSON_Delete??rA
    732          
    733            return error;  
   \   000001CC   0C009DE5           LDR      R0,[SP, #+12]
   \                     ??parse_answer_messages_getConversations_0:
   \   000001D0   2CD08DE2           ADD      SP,SP,#+44       ;; stack cleaning
   \   000001D4   F08FBDE8           POP      {R4-R11,PC}      ;; return
    734          }

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable30:
   \   00000000   ........           DC32     `?<Constant "%s/execute.getHistory...">`

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable36:
   \   00000000   ........           DC32     t_id

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable43:
   \   00000000   ........           DC32     profiles

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable51:
   \   00000000   ........           DC32     my_id

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable52:
   \   00000000   ........           DC32     recv_buf

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable53:
   \   00000000   ........           DC32     HTTP_CONTENT_LENGTH

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable54:
   \   00000000   ........           DC32     HTTP_HEADER_LENGTH

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable56:
   \   00000000   ........           DC32     `?<Constant "access_token">`

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable57:
   \   00000000   ........           DC32     dialogs

   \                                 In segment DATA_C, align 4, align-sorted
   \   00000000   6B657900           DC8 "key"

   \                                 In segment DATA_C, align 1, align-sorted
   \   00000000   747300             DC8 "ts"

   \                                 In segment DATA_C, align 4, align-sorted
   \   00000000   70747300           DC8 "pts"

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "error_code">`:
   \   00000000   6572726F725F       DC8 "error_code"
   \              636F646500  
   \   0000000B   00                 DC8 0
   \   0000000C   6572726F725F       DC8 "error_msg"
   \              6D736700    
   \   00000016   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \   00000000   6F757400           DC8 "out"
    735          
    736          
    737          /* Старые функции, под xml данные.
    738          
    739          int parse_answer_messages_get(int* item_count, int* result_out)
    740          {
    741            int err=0;
    742            int n=0;
    743            CLIST*c;
    744            char* body_utf8;
    745            char* url;
    746            int url_len;
    747          
    748            WSHDR* body_ws; 
    749            int count;
    750            int id;//for message
    751            unsigned date;
    752            int user_id;
    753            int read_state;
    754            int out;
    755            int emoji;  
    756            int attach;
    757            
    758            char* s=recv_buf+HTTP_HEADER_LENGTH;
    759            char* msgblk;
    760            char* msgblk_end;
    761            
    762            char* start_tag=NULL;
    763            char* end_tag=NULL;
    764            
    765            if (err=checkError(s))
    766              return err;
    767            
    768            count=0;
    769            if (s=strstr(s, "<count>"))
    770            {
    771              s+=7;
    772              count=strtol(s, 0, 10);
    773            }
    774            
    775            if(count==0)
    776              return err;
    777            
    778            if (strstr(s, "<message>"))
    779            {
    780              start_tag="<message>";
    781              end_tag="</message>";
    782            }
    783            else
    784            {
    785              start_tag="<item>";
    786              end_tag="</item>";
    787            }
    788            
    789            if (start_tag==NULL || end_tag==NULL)
    790              return parseError();
    791            
    792            while (msgblk=strstr(s, start_tag))
    793            {
    794              if(msgblk_end=strstr(s, end_tag))
    795                 *msgblk_end='\0';
    796              else
    797                return parseError();
    798              
    799              id=0; 
    800              if(s=strstr(msgblk, "<id>"))
    801              {
    802                s+=4;
    803                id=strtol(s, 0, 10); 
    804               }
    805              
    806              date=0;
    807              if(s=strstr(msgblk, "<date>"))
    808              {
    809                s+=6;
    810                date=strtol(s, 0, 10); 
    811               }    
    812          
    813              user_id=0;
    814              if(s=strstr(msgblk, "<user_id>"))
    815              {
    816                s+=9;
    817                user_id=strtol(s, 0, 10);
    818              }
    819          
    820              read_state=0;
    821              if(s=strstr(msgblk, "<read_state>"))
    822              {
    823                s+=12;
    824                read_state=strtol(s, 0, 10); 
    825              }
    826              
    827              out=0;
    828              if(s=strstr(msgblk, "<out>"))
    829              {
    830                s+=5;
    831                out=strtol(s, 0, 10); 
    832              }
    833                 
    834              body_utf8=NULL;
    835              body_ws=NULL;
    836              emoji=0;
    837              if(s=strstr(msgblk, "<body>"))
    838              {
    839                s+=6;
    840                char* body_end=strstr(s, "</body>"); 
    841                *body_end='\0';
    842                body_utf8=Replace_Special_Syms(s);
    843                *body_end='<';      
    844                
    845                if (s=strstr(s, "<emoji>"))
    846                {
    847                  s+=7;
    848                  emoji=strtol(s, 0, 10);
    849                }
    850              }
    851              
    852              attach=0;
    853              url=NULL;
    854              if (s=strstr(msgblk, "<attachment>"))
    855              {
    856                if (s=strstr(s, "<type>"))
    857                {
    858                  s+=6;
    859                  for (; *s == ' ' || *s == '\n' || *s == '\r'; s++);
    860                   
    861                  if (strncmp(s, "wall", 4)==0)
    862                    attach=8;
    863                  else
    864                    if (strncmp(s, "photo", 5)==0)
    865                      attach=1;
    866                    else
    867                      if (strncmp(s, "video", 5)==0)
    868                      attach=2;
    869                    else
    870                      if (strncmp(s, "link", 4)==0)
    871                      {
    872                        if(s=strstr(s, "<url>"))
    873                        {
    874                          s+=5;
    875                          url=s;
    876                          url_len=strstr(s, "</url>")-s;
    877                          attach=5;
    878                        }
    879                      }
    880                }
    881              }
    882              
    883              *msgblk_end='<';
    884              s=msgblk_end+strlen(end_tag);
    885              
    886              if (body_utf8)
    887              {
    888                int len=strlen(body_utf8);
    889                if (emoji)
    890                  len=Replace_Smiles_Syms(body_utf8);
    891          
    892                body_ws=AllocWS(utf8_syms_n(body_utf8, len));
    893                utf8_2ws(body_ws, body_utf8, len);
    894                mfree(body_utf8);
    895              }
    896              else
    897                if (url)
    898                {
    899                  body_ws=AllocWS(url_len);
    900                  str_2ws(body_ws, url, url_len);
    901                 }
    902          
    903              
    904              if (user_id && date)//иначе итем без полезной инфы
    905              {
    906              
    907              if ((c=FindContactById(csm->dialogs_list, user_id))==0)//если контакта нет в списке
    908                c=CreateContact(user_id);
    909                //тут можно скопировать данные контакта из списка друзей
    910          
    911              
    912              PERSONAL_MSG* msg=FindMsgById(c, id);
    913          
    914              if (msg)//если сообщение уже есть в списке,то обновим его статус прочтения
    915              {
    916                msg->read_state=read_state;
    917                if (body_ws)
    918                  FreeWS(body_ws); 
    919              }
    920                
    921              else//новое сообщение
    922              {
    923                msg=AllocMSG();
    924                msg->id=id;
    925                msg->date=date;
    926                msg->user_id=user_id; 
    927                msg->read_state=read_state;
    928                msg->out=out;
    929                msg->body=body_ws;
    930                msg->emoji=emoji;
    931                msg->attach=attach;
    932                
    933                AddMsg(c, msg);  
    934                AddContactToList(&csm->dialogs_list, c);
    935                
    936                if (out==0 && msg->read_state==0)
    937                  total_unread_messages++;
    938                
    939                if (out)
    940                  *result_out=1;
    941                
    942                if (msg->id > last_message_id)
    943                  last_message_id=msg->id;
    944                
    945                n++;
    946              }
    947              }
    948            }
    949            *item_count=n;
    950            return err;
    951          }
    952          
    953          
    954          
    955          int parse_answer_messages_getHistory()
    956          {
    957            int result_count;
    958            int result_out;
    959            return parse_answer_messages_get(&result_count, &result_out);  
    960          }
    961          
    962          
    963          
    964          int parse_answer_messages_getDialogs()
    965          {
    966            int result_count;
    967            int result_out;
    968            return parse_answer_messages_get(&result_count, &result_out);
    969          }
    970          
    971          
    972          
    973          int parse_answer_groups_get(CLIST** cltop_adr)
    974          {
    975            int err=0;
    976            CLIST* c;
    977            CLIST** cl=(CLIST**)cltop_adr;
    978            WSHDR* ws1;
    979            WSHDR* ws2;
    980            
    981            int id=0;
    982            const char* first_name;//for name
    983            const char* last_name;//for sreen_name
    984            const char* photo50_url;  
    985            int first_name_len=0;
    986            int last_name_len=0;
    987            int photo50_url_len=0;
    988            int deactivated;
    989            
    990            char* content=recv_buf+HTTP_HEADER_LENGTH;
    991            char* userblk;
    992            char* userblk_end;
    993            char* s=content;
    994            
    995            if (err=checkError(content))
    996              return err;
    997            
    998             while (userblk=strstr(s, "<group>"))
    999             {
   1000               s=userblk+6;
   1001               userblk_end=strstr(s, "</group>");
   1002               *userblk_end='\0';
   1003              
   1004               id=0;
   1005               if(s=strstr(userblk, "<id>"))
   1006               {
   1007                 s+=4;
   1008                 id=strtol(s, 0, 10);
   1009                 if (id > 0)
   1010                   id=-id; //тут знак у id положительный-делаем отрицательным
   1011               }
   1012               
   1013               first_name=NULL;
   1014               if(s=strstr(userblk, "<name>"))
   1015               {
   1016                 s+=6;
   1017                 first_name=s;
   1018                 first_name_len=strstr(s, "</name>") - s;
   1019                 s+=first_name_len;
   1020               }
   1021               
   1022               last_name=NULL;
   1023               if(s=strstr(userblk, "<screen_name>"))
   1024               {
   1025                 s+=13;
   1026                 last_name=s;
   1027                 last_name_len=strstr(s, "</screen_name>") - s;
   1028                 s+=last_name_len;         
   1029               }
   1030          
   1031               deactivated=0;
   1032               if(s=strstr(userblk, "<deactivated>"))
   1033                 deactivated=1;        
   1034               
   1035               photo50_url=NULL;
   1036               if(s=strstr(userblk, "<photo_50>"))
   1037               {
   1038                 s+=10;
   1039                 photo50_url=s;
   1040                 photo50_url_len=strstr(s, "</photo_50>") - s;
   1041                 s+=photo50_url_len;
   1042               }
   1043               
   1044               s=userblk_end+7;   
   1045               
   1046               
   1047               if ((c=FindContactById(*cl, id))==0)
   1048               {
   1049                 c=CreateContact(id);
   1050                 AddContactToList(cl, c);
   1051               }
   1052               
   1053               if (c->first_name)
   1054                 FreeWS(c->first_name);
   1055               if (c->last_name)
   1056                 FreeWS(c->last_name);
   1057               
   1058               ws1=AllocWS(65);
   1059               ws2=AllocWS(65);
   1060               utf8_2ws(ws1, first_name, first_name_len);
   1061               utf8_2ws(ws2, last_name, last_name_len);
   1062               c->first_name=ws1;
   1063               c->last_name=ws2;
   1064               c->deactivated=deactivated;
   1065               c->photo_url=malloc(photo50_url_len+1);
   1066               strncpy(c->photo_url, photo50_url, photo50_url_len);
   1067               c->photo_url[photo50_url_len]='\0';
   1068             }
   1069             return err;
   1070          }
   1071          
   1072          
   1073          int parse_answer_messages_send()
   1074          {
   1075            int err=0;
   1076            char* s=recv_buf+HTTP_HEADER_LENGTH;
   1077            
   1078            if (err=checkError(s))
   1079              return err;
   1080            
   1081            return err;
   1082          }
   1083          
   1084          int parse_answer_messages_deleteDialog(int* user_id)
   1085          {
   1086            int err=0;
   1087            char* s=recv_buf+HTTP_HEADER_LENGTH;
   1088            
   1089            *user_id=last_user_id;
   1090            
   1091            if (err=checkError(s))
   1092              return err;
   1093            
   1094            return err;
   1095          }
   1096          
   1097          int parse_answer_friends_get()
   1098          {
   1099            return parse_answer_users_get();  
   1100          }
   1101          
   1102          
   1103          int parse_answer_wall_get(int* item_count)//!!!рассчитано на чтение только одного сообщения
   1104          {
   1105            int err=0;
   1106            int n=0;
   1107            CLIST*c;
   1108            WALL_MSG* msg;
   1109            char* text_utf8;
   1110          
   1111            WSHDR* text_ws; 
   1112            int id;
   1113            unsigned date;
   1114            int from_id;
   1115            int owner_id;
   1116            int emoji;  
   1117            WALL_ATTACH* attach_list=NULL;
   1118            int likes;
   1119            int comments;
   1120            
   1121            char* s=recv_buf+HTTP_HEADER_LENGTH;
   1122            char* postblk;
   1123            char* postblk_end;
   1124            
   1125            if (err=checkError(s))
   1126              return err;
   1127            
   1128            if (postblk=strstr(s, "<post>"))
   1129            {
   1130              s=postblk + (sizeof("<post>")-1);
   1131          
   1132              if(postblk_end=strstr(s, "</post>"))
   1133                 *postblk_end='\0';
   1134              else
   1135                return parseError();
   1136              
   1137              id=0; 
   1138              if(s=strstr(postblk, "<id>"))
   1139              {
   1140                s+=4;
   1141                id=strtol(s, 0, 10); 
   1142               }
   1143              
   1144              from_id=0;
   1145              if(s=strstr(postblk, "<from_id>"))
   1146              {
   1147                s+=9;
   1148                from_id=strtol(s, 0, 10);
   1149              }
   1150              
   1151              owner_id=0;
   1152              if(s=strstr(postblk, "<owner_id>"))
   1153              {
   1154                s+=10;
   1155                owner_id=strtol(s, 0, 10);
   1156              }    
   1157          
   1158              date=0;
   1159              if(s=strstr(postblk, "<date>"))
   1160              {
   1161                s+=6;
   1162                date=strtol(s, 0, 10);
   1163              }    
   1164              
   1165              text_utf8=NULL;
   1166              text_ws=NULL;
   1167              emoji=0;
   1168              if(s=strstr(postblk, "<text>"))
   1169              {
   1170                s+=6;
   1171                char* text_end=strstr(s, "</text>");
   1172                *text_end='\0';
   1173                text_utf8=Replace_Special_Syms(s);
   1174                *text_end='<';
   1175                
   1176                if (s=strstr(s, "<emoji>"))
   1177                {
   1178                  s+=7;
   1179                  emoji=strtol(s, 0, 10);
   1180                }
   1181              }
   1182          //------------------------------------------------------------------------------    
   1183              attach_list=NULL;                                  
   1184              char* attachblk=postblk; 
   1185              while (s=strstr(attachblk, "<attachment>"))
   1186              {
   1187                char* attachblk_end=strstr(attachblk, "</attachment>");
   1188                *attachblk_end='\0';
   1189                  
   1190                if (s=strstr(s, "<type>"))
   1191                {
   1192                  s+=6;
   1193                  for (; *s == ' ' || *s == '\n' || *s == '\r'; s++);
   1194                  
   1195                  if (strncmp(s, "photo", 5)==0)
   1196                  {
   1197                    if(s=strstr(s, "<photo_604>"))//130 маловат а 604 большой:(
   1198                    {
   1199                      s+=11; 
   1200                      int len=strstr(s, "</photo_604>") - s;
   1201                      WALL_ATTACH* wall_attach=malloc(sizeof(WALL_ATTACH));
   1202                      wall_attach->next=0;
   1203                      wall_attach->type=1;
   1204                      wall_attach->url=malloc(len+1);
   1205                      strncpy(wall_attach->url, s, len);
   1206                      wall_attach->url[len]='\0';
   1207                      WALL_ATTACH* a=attach_list;
   1208                      while (a)
   1209                      {
   1210                        if (a->next==0)
   1211                          break;
   1212                        a=a->next;
   1213                      }
   1214                      if (a)
   1215                        a->next=wall_attach;
   1216                      else
   1217                        attach_list=wall_attach;
   1218                    }
   1219                  }
   1220                  else
   1221                    if (strncmp(s, "link", 4)==0)
   1222                    {
   1223                      if(s=strstr(s, "<url>"))
   1224                      {
   1225                        s+=5;
   1226                        int len=strstr(s, "</url>") - s;
   1227                        WALL_ATTACH* wall_attach=malloc(sizeof(WALL_ATTACH));
   1228                        wall_attach->next=0;
   1229                        wall_attach->type=7;
   1230                        wall_attach->url=malloc(len+1);
   1231                        strncpy(wall_attach->url, s, len);
   1232                        wall_attach->url[len]='\0';
   1233                        WALL_ATTACH* a=attach_list;
   1234                        while (a)
   1235                        {
   1236                          if (a->next==0)
   1237                          break;
   1238                        a=a->next;
   1239                        }
   1240                        if (a)
   1241                          a->next=wall_attach;
   1242                        else
   1243                          attach_list=wall_attach;            
   1244                      }
   1245                    }
   1246                    else
   1247                      if (strncmp(s, "video", 5)==0)
   1248                      {
   1249                        WALL_ATTACH* wall_attach=malloc(sizeof(WALL_ATTACH));
   1250                        wall_attach->next=0;   
   1251                        wall_attach->type=3;
   1252                        wall_attach->url=NULL;
   1253                        WALL_ATTACH* a=attach_list;
   1254                        while (a)
   1255                        {
   1256                          if (a->next==0)
   1257                            break;
   1258                          a=a->next;
   1259                        }
   1260                        if (a)
   1261                          a->next=wall_attach;
   1262                        else
   1263                          attach_list=wall_attach;  
   1264                      }
   1265                }
   1266                
   1267                *attachblk_end='<';
   1268                attachblk=attachblk_end + (sizeof("</attachment>")-1);
   1269              }     
   1270          //------------------------------------------------------------------------------  
   1271              comments=0;
   1272              if (s=strstr(postblk, "<comments>"))
   1273              {
   1274                if(s=strstr(s, "<count>"))
   1275                {
   1276                  s+=(sizeof("<count>")-1);
   1277                  comments=strtol(s, 0, 10);
   1278                }
   1279              }
   1280              
   1281              likes=0;
   1282              if (s=strstr(postblk, "<likes>"))
   1283              {
   1284                if(s=strstr(s, "<count>"))
   1285                {
   1286                  s+=(sizeof("<count>")-1);
   1287                  likes=strtol(s, 0, 10);
   1288                }
   1289              }    
   1290          //------------------------------------------------------------------------------    
   1291              *postblk_end='<';
   1292              s=postblk_end+7;
   1293              
   1294              if (text_utf8)
   1295              {
   1296                int len=strlen(text_utf8);
   1297                if (emoji)
   1298                  len=Replace_Smiles_Syms(text_utf8);
   1299          
   1300                text_ws=AllocWS(utf8_syms_n(text_utf8, len));
   1301                utf8_2ws(text_ws, text_utf8, len);
   1302                mfree(text_utf8);
   1303              }
   1304              
   1305              if (from_id && date)//иначе итем без полезной инфы
   1306              {
   1307                if ((c=FindContactById(csm->groups_list, owner_id))==0)
   1308                  c=CreateContact(id);
   1309                
   1310                msg=(WALL_MSG*)FindMsgById(c, id);
   1311          
   1312              if (msg)//если сообщение уже есть в списке
   1313              {
   1314                if (text_ws)
   1315                  FreeWS(text_ws);      
   1316              }
   1317              else//новое сообщение
   1318              {
   1319                msg=malloc(sizeof(WALL_MSG));
   1320                msg->next=0;
   1321                msg->prev=0;
   1322                msg->id=id;
   1323                msg->from_id=from_id;
   1324                msg->date=date;
   1325                msg->owner_id=owner_id;
   1326                msg->date=date;
   1327                msg->text=text_ws;
   1328                msg->emoji=emoji;
   1329                msg->attach_list=attach_list;
   1330                msg->comments=comments;
   1331                msg->likes=likes;
   1332                
   1333                c->wall_msglist=msg;  
   1334                
   1335                n++;
   1336              }
   1337              }
   1338            }
   1339            
   1340            *item_count=n;
   1341            
   1342            s=postblk_end + (sizeof("</post>")-1);
   1343            msg->profiles=NULL;
   1344            parse_answer_users_get();
   1345            
   1346            return err;
   1347          }
   1348          
   1349          */
   1350          

   Maximum stack usage in bytes:

     Function                       CSTACK
     --------                       ------
     __parse_answer_friends_get         4
     __parse_answer_users_get          60
     __parse_obj_Error                 16
     __parse_obj_Group                 28
     __parse_obj_Message               28
     __parse_obj_User                  16
     __parse_obj_groups                60
     __parse_obj_profiles              56
     parse_answer_auth_direct          28
     parse_answer_groups_get           28
     parse_answer_messages_getConversations
                                       80
     parse_answer_messages_getLongPollHistory
                                       60
     parse_answer_messages_getLongPollServer
                                       24
     url_auth_direct                   32
     url_execute_getHistory            28
     url_execute_sendAndGet            28
     url_friends_get                   36
     url_groups_get                    28
     url_groups_getById                28
     url_messages_deleteDialog         28
     url_messages_getConversations     36
     url_messages_getHistory           32
     url_messages_getLongPollHistory
                                       36
     url_messages_getLongPollServer    32
     url_messages_markAsRead           28
     url_messages_send                 32
     url_stats_track_visitor           20
     url_users_get                     28
     url_wall_get                      32


   Segment part sizes:

     Function/Label                 Bytes
     --------------                 -----
     ?<Constant "access_token">      220
     t_id                            216
     ?<Constant "%s/execute.getHistory...">
                                    1268
     captcha_img                     128
     my_id                          1644
     captcha_seed                      4
     url_auth_direct                  68
     ?Subroutine31                    24
     url_stats_track_visitor          64
     url_messages_getLongPollServer   68
     url_messages_getLongPollHistory
                                      80
     ?Subroutine29                    44
     url_messages_getConversations    44
     url_users_get                    64
     ?Subroutine30                    28
     url_messages_getHistory          56
     url_messages_deleteDialog        52
     url_messages_markAsRead          64
     url_friends_get                  40
     url_messages_send                92
     url_groups_get                   60
     url_groups_getById               60
     url_wall_get                     68
     url_execute_getHistory           44
     url_execute_sendAndGet           56
     __parse_obj_Error                84
     __parse_obj_Message             336
     __parse_obj_User                252
     __parse_obj_profiles            168
     __parse_obj_Group               344
     __parse_obj_groups              192
     parse_answer_groups_get         144
     ?Subroutine32                    16
     __parse_answer_users_get        236
     __parse_answer_friends_get        4
     parse_answer_auth_direct        296
     parse_answer_messages_getLongPollServer
                                     288
     parse_answer_messages_getLongPollHistory
                                     340
     parse_answer_messages_getConversations
                                     472
     ??DataTable30                     4
     ??DataTable36                     4
     ??DataTable43                     4
     ??DataTable51                     4
     ??DataTable52                     4
     ??DataTable53                     4
     ??DataTable54                     4
     ??DataTable56                     4
     ??DataTable57                     4
     ?<Constant "key">                 4
     ?<Constant "ts">                  3
     ?<Constant "pts">                 4
     ?<Constant "error_code">         24
     ?<Constant "out">                 4
      Others                         344

 
 4 616 bytes in segment CODE
 1 871 bytes in segment DATA_C
 1 648 bytes in segment DATA_Z
    12 bytes in segment INITTAB
 
 4 284 bytes of CODE  memory (+ 344 bytes shared)
 1 871 bytes of CONST memory
 1 648 bytes of DATA  memory

Errors: none
Warnings: 1
